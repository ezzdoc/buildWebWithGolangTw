<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>07.3 | 使用 Golang 打造 Web 應用程式</title>


<link rel="stylesheet" href="/buildWebWithGolangTw/book.min.89885fa0429ec73067282f26fc0c6d38cfc617a443ec4e835d47b821c52c6e92.css" integrity="sha256-iYhfoEKexzBnKC8m/AxtOM/GF6RD7E6DXUe4IcUsbpI=">


<script defer src="/buildWebWithGolangTw/search.min.4762838110f5450a8a33fcbe56c7ce734d09867f3e9ab5c1e6f7bbec99b65c68.js" integrity="sha256-R2KDgRD1RQqKM/y&#43;VsfOc00Jhn8&#43;mrXB5ve77Jm2XGg="></script>



<link rel="icon" href="/buildWebWithGolangTw/favicon.png" type="image/x-icon">

<base href="https://ezzdoc.com/buildWebWithGolangTw/">


<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav>
<h2 class="book-brand">
  <a href="https://ezzdoc.com/buildWebWithGolangTw/"><span>使用 Golang 打造 Web 應用程式</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" placeholder="Search" id="book-search-input" maxlength="64" readonly />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>





    
  
  
  

  <style>
  nav ul a[href$="\2f buildWebWithGolangTw\2f docs\2f 07.3\2f "] {
      color: #004ed0;
  }
  </style>

<ul>
<li><a href="/buildWebWithGolangTw/docs/preface/">目錄</a></li>
<li><a href="/buildWebWithGolangTw/docs/01.0/">1.Go 環境配置</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/01.1/">1.1 安裝 Go</a></li>
<li><a href="/buildWebWithGolangTw/docs/01.2/">1.2 GOPATH 與工作空間</a></li>
<li><a href="/buildWebWithGolangTw/docs/01.3/">1.3 Go 命令</a></li>
<li><a href="/buildWebWithGolangTw/docs/01.4/">1.4 Go 開發工具</a></li>
<li><a href="/buildWebWithGolangTw/docs/01.5/">1.5 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/02.0/">2.Go 語言基礎</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/02.1/">2.1 你好，Go</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.2/">2.2 Go 基礎</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.3/">2.3 流程和函式</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.4/">2.4 struct</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.5/">2.5 物件導向</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.6/">2.6 interface</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.7/">2.7 併發</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.8/">2.8 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/03.0/">3.Web 基礎</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/03.1/">3.1 web 工作方式</a></li>
<li><a href="/buildWebWithGolangTw/docs/03.2/">3.2 Go 建立一個簡單的 web 服務</a></li>
<li><a href="/buildWebWithGolangTw/docs/03.3/">3.3 Go 如何使得 web 工作</a></li>
<li><a href="/buildWebWithGolangTw/docs/03.4/">3.4 Go 的 http 套件詳解</a></li>
<li><a href="/buildWebWithGolangTw/docs/03.5/">3.5 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/04.0/">4.表單</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/04.1/">4.1 處理表單的輸入</a></li>
<li><a href="/buildWebWithGolangTw/docs/04.2/">4.2 驗證表單的輸入</a></li>
<li><a href="/buildWebWithGolangTw/docs/04.3/">4.3 預防跨站指令碼</a></li>
<li><a href="/buildWebWithGolangTw/docs/04.4/">4.4 防止多次提交表單</a></li>
<li><a href="/buildWebWithGolangTw/docs/04.5/">4.5 處理檔案上傳</a></li>
<li><a href="/buildWebWithGolangTw/docs/04.6/">4.6 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/05.0/">5.訪問資料庫</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/05.1/">5.1 database/sql 介面</a></li>
<li><a href="/buildWebWithGolangTw/docs/05.2/">5.2 使用 MySQL 資料庫</a></li>
<li><a href="/buildWebWithGolangTw/docs/05.3/">5.3 使用 SQLite 資料庫</a></li>
<li><a href="/buildWebWithGolangTw/docs/05.4/">5.4 使用 PostgreSQL 資料庫</a></li>
<li><a href="/buildWebWithGolangTw/docs/05.5/">5.5 使用 Beego orm 函式庫進行 ORM 開發</a></li>
<li><a href="/buildWebWithGolangTw/docs/05.6/">5.6 NOSQL 資料庫操作</a></li>
<li><a href="/buildWebWithGolangTw/docs/05.7/">5.7 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/06.0/">6.session 和資料儲存</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/06.1/">6.1 session 和 cookie</a></li>
<li><a href="/buildWebWithGolangTw/docs/06.2/">6.2 Go 如何使用 session</a></li>
<li><a href="/buildWebWithGolangTw/docs/06.3/">6.3 session 儲存</a></li>
<li><a href="/buildWebWithGolangTw/docs/06.4/">6.4 預防 session 劫持</a></li>
<li><a href="/buildWebWithGolangTw/docs/06.5/">6.5 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/07.0/">7.文字檔案處理</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/07.1/">7.1 XML 處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/07.2/">7.2 JSON 處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/07.3/">7.3 正則處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/07.4/">7.4 範本處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/07.5/">7.5 檔案操作</a></li>
<li><a href="/buildWebWithGolangTw/docs/07.6/">7.6 字串處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/07.7/">7.7 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/08.0/">8.Web 服務</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/08.1/">8.1 Socket 程式設計</a></li>
<li><a href="/buildWebWithGolangTw/docs/08.2/">8.2 WebSocket</a></li>
<li><a href="/buildWebWithGolangTw/docs/08.3/">8.3 REST</a></li>
<li><a href="/buildWebWithGolangTw/docs/08.4/">8.4 RPC</a></li>
<li><a href="/buildWebWithGolangTw/docs/08.5/">8.5 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/09.0/">9.安全與加密</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/09.1/">9.1 預防 CSRF 攻擊</a></li>
<li><a href="/buildWebWithGolangTw/docs/09.2/">9.2 確保輸入過濾</a></li>
<li><a href="/buildWebWithGolangTw/docs/09.3/">9.3 避免 XSS 攻擊</a></li>
<li><a href="/buildWebWithGolangTw/docs/09.4/">9.4 避免 SQL 注入</a></li>
<li><a href="/buildWebWithGolangTw/docs/09.5/">9.5 儲存密碼</a></li>
<li><a href="/buildWebWithGolangTw/docs/09.6/">9.6 加密和解密資料</a></li>
<li><a href="/buildWebWithGolangTw/docs/09.7/">9.7 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/10.0/">10.國際化和本地化</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/10.1/">10.1 設定預設地區</a></li>
<li><a href="/buildWebWithGolangTw/docs/10.2/">10.2 本地化資源</a></li>
<li><a href="/buildWebWithGolangTw/docs/10.3/">10.3 國際化站點</a></li>
<li><a href="/buildWebWithGolangTw/docs/10.4/">10.4 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/11.0/">11.錯誤處理，除錯和測試</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/11.1/">11.1 錯誤處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/11.2/">11.2 使用 GDB 除錯</a></li>
<li><a href="/buildWebWithGolangTw/docs/11.3/">11.3 Go 怎麼寫測試案例</a></li>
<li><a href="/buildWebWithGolangTw/docs/11.4/">11.4 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/12.0/">12.部署與維護</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/12.1/">12.1 應用日誌</a></li>
<li><a href="/buildWebWithGolangTw/docs/12.2/">12.2 網站錯誤處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/12.3/">12.3 應用部署</a></li>
<li><a href="/buildWebWithGolangTw/docs/12.4/">12.4 備份和還原</a></li>
<li><a href="/buildWebWithGolangTw/docs/12.5/">12.5 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/13.0/">13.如何設計一個 Web 框架</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/13.1/">13.1 專案規劃</a></li>
<li><a href="/buildWebWithGolangTw/docs/13.2/">13.2 自訂路由器設計</a></li>
<li><a href="/buildWebWithGolangTw/docs/13.3/">13.3 controller 設計</a></li>
<li><a href="/buildWebWithGolangTw/docs/13.4/">13.4 日誌和配置設計</a></li>
<li><a href="/buildWebWithGolangTw/docs/13.5/">13.5 實現部落格的增刪改</a></li>
<li><a href="/buildWebWithGolangTw/docs/13.6/">13.6 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/14.0/">14.擴充套件 Web 框架</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/14.1/">14.1 靜態檔案支援</a></li>
<li><a href="/buildWebWithGolangTw/docs/14.2/">14.2 Session 支援</a></li>
<li><a href="/buildWebWithGolangTw/docs/14.3/">14.3 表單支援</a></li>
<li><a href="/buildWebWithGolangTw/docs/14.4/">14.4 使用者認證</a></li>
<li><a href="/buildWebWithGolangTw/docs/14.5/">14.5 多語言支援</a></li>
<li><a href="/buildWebWithGolangTw/docs/14.6/">14.6 pprof 支援</a></li>
<li><a href="/buildWebWithGolangTw/docs/14.7/">14.7 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/ref/">附錄 A 參考資料</a></li>
</ul>







</nav>


<script>
(function() {
  var menu = document.querySelector("aside.book-menu nav");
  addEventListener("beforeunload", function(event) {
    localStorage.setItem("menu.scrollTop", menu.scrollTop);
  });
  menu.scrollTop = localStorage.getItem("menu.scrollTop");
})();
</script>

    </aside>

    <div class="book-page">
      <header class="flex align-center justify-between book-header">
  <label for="menu-control">
    <img src="/buildWebWithGolangTw/svg/menu.svg" alt="Menu" />
  </label>
  <strong>07.3</strong>
</header>

      
<article class="markdown">

<h1 id="7-3-正則處理">7.3 正則處理</h1>

<p>正則表示式是一種進行模式匹配和文字操縱的複雜而又強大的工具。雖然正則表示式比純粹的文字匹配效率低，但是它卻更靈活。按照它的語法規則，隨需構造出的匹配模式就能夠從原始文字中篩選出幾乎任何你想要得到的字元組合。如果你在 Web 開發中需要從一些文字資料來源中取得資料，那麼你只需要按照它的語法規則，隨需構造出正確的模式字串就能夠從原資料來源提取出有意義的文字資訊。</p>

<p>Go 語言透過 <code>regexp</code> 標準套件為正則表示式提供了官方支援，如果你已經使用過其他程式語言提供的正則相關功能，那麼你應該對 Go 語言版本的不會太陌生，但是它們之間也有一些小的差異，因為 Go 實現的是 RE2 標準，除了\C，詳細的語法描述參考：<code>http://code.google.com/p/re2/wiki/Syntax</code></p>

<p>其實字串處理我們可以使用 <code>strings</code> 套件來進行搜尋(Contains、Index)、替換(Replace)和解析(Split、Join)等操作，但是這些都是簡單的字串操作，他們的搜尋都是區分大小寫的，而且固定的字串，如果我們需要匹配可變的那種就沒辦法實現了，當然如果 <code>strings</code> 套件能解決你的問題，那麼就儘量使用它來解決。因為他們足夠簡單、而且效能和可讀性都會比正則好。</p>

<p>如果你還記得，在前面表單驗證的小節裡，我們已經接觸過正則處理，在那裡我們利用了它來驗證輸入的資訊是否滿足某些預設的條件。在使用中需要注意的一點就是：所有的字元都是 UTF-8 編碼的。接下來讓我們更加深入的來學習 Go 語言的 <code>regexp</code> 套件相關知識吧。</p>

<h2 id="透過正則判斷是否匹配">透過正則判斷是否匹配</h2>

<p><code>regexp</code>套件中含有三個函式用來判斷是否匹配，如果匹配回傳 true，否則回傳 false</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Match</span>(<span style="color:#a6e22e">pattern</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">b</span> []<span style="color:#66d9ef">byte</span>) (<span style="color:#a6e22e">matched</span> <span style="color:#66d9ef">bool</span>, <span style="color:#66d9ef">error</span> <span style="color:#66d9ef">error</span>)
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">MatchReader</span>(<span style="color:#a6e22e">pattern</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">r</span> <span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">RuneReader</span>) (<span style="color:#a6e22e">matched</span> <span style="color:#66d9ef">bool</span>, <span style="color:#66d9ef">error</span> <span style="color:#66d9ef">error</span>)
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">MatchString</span>(<span style="color:#a6e22e">pattern</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">s</span> <span style="color:#66d9ef">string</span>) (<span style="color:#a6e22e">matched</span> <span style="color:#66d9ef">bool</span>, <span style="color:#66d9ef">error</span> <span style="color:#66d9ef">error</span>)</code></pre></div>
<p>上面的三個函式實現了同一個功能，就是判斷 <code>pattern</code> 是否和輸入源匹配，匹配的話就回傳 true，如果解析正則出錯則回傳 error。三個函式的輸入源分別是 byte slice、RuneReader 和 string。</p>

<p>如果要驗證一個輸入是不是 IP 地址，那麼如何來判斷呢？請看如下實現</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">IsIP</span>(<span style="color:#a6e22e">ip</span> <span style="color:#66d9ef">string</span>) (<span style="color:#a6e22e">b</span> <span style="color:#66d9ef">bool</span>) {
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">m</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">regexp</span>.<span style="color:#a6e22e">MatchString</span>(<span style="color:#e6db74">&#34;^[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}$&#34;</span>, <span style="color:#a6e22e">ip</span>); !<span style="color:#a6e22e">m</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>
}</code></pre></div>
<p>可以看到，<code>regexp</code>的 pattern 和我們平常使用的正則一模一樣。再來看一個例子：當用戶輸入一個字串，我們想知道是不是一次合法的輸入：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#66d9ef">if</span> len(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Args</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Usage: regexp [string]&#34;</span>)
		<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Exit</span>(<span style="color:#ae81ff">1</span>)
	} <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">m</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">regexp</span>.<span style="color:#a6e22e">MatchString</span>(<span style="color:#e6db74">&#34;^[0-9]+$&#34;</span>, <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Args</span>[<span style="color:#ae81ff">1</span>]); <span style="color:#a6e22e">m</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;數字&#34;</span>)
	} <span style="color:#66d9ef">else</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;不是數字&#34;</span>)
	}
}</code></pre></div>
<p>在上面的兩個小例子中，我們採用了 Match(Reader|String)來判斷一些字串是否符合我們的描述需求，它們使用起來非常方便。</p>

<h2 id="透過正則取得內容">透過正則取得內容</h2>

<p>Match 模式只能用來對字串的判斷，而無法擷取字串的一部分、過濾字串、或者提取出符合條件的一批字串。如果想要滿足這些需求，那就需要使用正則表示式的複雜模式。</p>

<p>我們經常需要一些爬蟲程式，下面就以爬蟲為例來說明如何使用正則來過濾或擷取抓取到的資料：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;fmt&#34;</span>
	<span style="color:#e6db74">&#34;io/ioutil&#34;</span>
	<span style="color:#e6db74">&#34;net/http&#34;</span>
	<span style="color:#e6db74">&#34;regexp&#34;</span>
	<span style="color:#e6db74">&#34;strings&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#a6e22e">resp</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;http://www.baidu.com&#34;</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;http get error.&#34;</span>)
	}
	<span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">resp</span>.<span style="color:#a6e22e">Body</span>.<span style="color:#a6e22e">Close</span>()
	<span style="color:#a6e22e">body</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ioutil</span>.<span style="color:#a6e22e">ReadAll</span>(<span style="color:#a6e22e">resp</span>.<span style="color:#a6e22e">Body</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;http read error&#34;</span>)
		<span style="color:#66d9ef">return</span>
	}

	<span style="color:#a6e22e">src</span> <span style="color:#f92672">:=</span> string(<span style="color:#a6e22e">body</span>)

	<span style="color:#75715e">//將 HTML 標籤全轉換成小寫
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">re</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">regexp</span>.<span style="color:#a6e22e">Compile</span>(<span style="color:#e6db74">&#34;\\&lt;[\\S\\s]+?\\&gt;&#34;</span>)
	<span style="color:#a6e22e">src</span> = <span style="color:#a6e22e">re</span>.<span style="color:#a6e22e">ReplaceAllStringFunc</span>(<span style="color:#a6e22e">src</span>, <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">ToLower</span>)

	<span style="color:#75715e">//去除 STYLE
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">re</span>, <span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">regexp</span>.<span style="color:#a6e22e">Compile</span>(<span style="color:#e6db74">&#34;\\&lt;style[\\S\\s]+?\\&lt;/style\\&gt;&#34;</span>)
	<span style="color:#a6e22e">src</span> = <span style="color:#a6e22e">re</span>.<span style="color:#a6e22e">ReplaceAllString</span>(<span style="color:#a6e22e">src</span>, <span style="color:#e6db74">&#34;&#34;</span>)

	<span style="color:#75715e">//去除 SCRIPT
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">re</span>, <span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">regexp</span>.<span style="color:#a6e22e">Compile</span>(<span style="color:#e6db74">&#34;\\&lt;script[\\S\\s]+?\\&lt;/script\\&gt;&#34;</span>)
	<span style="color:#a6e22e">src</span> = <span style="color:#a6e22e">re</span>.<span style="color:#a6e22e">ReplaceAllString</span>(<span style="color:#a6e22e">src</span>, <span style="color:#e6db74">&#34;&#34;</span>)

	<span style="color:#75715e">//去除所有尖括號內的 HTML 程式碼，並換成換行符
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">re</span>, <span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">regexp</span>.<span style="color:#a6e22e">Compile</span>(<span style="color:#e6db74">&#34;\\&lt;[\\S\\s]+?\\&gt;&#34;</span>)
	<span style="color:#a6e22e">src</span> = <span style="color:#a6e22e">re</span>.<span style="color:#a6e22e">ReplaceAllString</span>(<span style="color:#a6e22e">src</span>, <span style="color:#e6db74">&#34;\n&#34;</span>)

	<span style="color:#75715e">//去除連續的換行符
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">re</span>, <span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">regexp</span>.<span style="color:#a6e22e">Compile</span>(<span style="color:#e6db74">&#34;\\s{2,}&#34;</span>)
	<span style="color:#a6e22e">src</span> = <span style="color:#a6e22e">re</span>.<span style="color:#a6e22e">ReplaceAllString</span>(<span style="color:#a6e22e">src</span>, <span style="color:#e6db74">&#34;\n&#34;</span>)

	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">TrimSpace</span>(<span style="color:#a6e22e">src</span>))
}</code></pre></div>
<p>從這個範例可以看出，使用複雜的正則首先是 Compile，它會解析正則表示式是否合法，如果正確，那麼就會回傳一個 Regexp，然後就可以利用回傳的 Regexp 在任意的字串上面執行需要的操作。</p>

<p>解析正則表示式的有如下幾個方法：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Compile</span>(<span style="color:#a6e22e">expr</span> <span style="color:#66d9ef">string</span>) (<span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>, <span style="color:#66d9ef">error</span>)
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">CompilePOSIX</span>(<span style="color:#a6e22e">expr</span> <span style="color:#66d9ef">string</span>) (<span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>, <span style="color:#66d9ef">error</span>)
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">MustCompile</span>(<span style="color:#a6e22e">str</span> <span style="color:#66d9ef">string</span>) <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">MustCompilePOSIX</span>(<span style="color:#a6e22e">str</span> <span style="color:#66d9ef">string</span>) <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span></code></pre></div>
<p>CompilePOSIX 和 Compile 的不同點在於 POSIX 必須使用 POSIX 語法，它使用最左最長方式搜尋，而 Compile 是採用的則只採用最左方式搜尋(例如[a-z]{2,4}這樣一個正則表示式，應用於&rdquo;aa09aaa88aaaa&rdquo;這個文字串時，CompilePOSIX 回傳了 aaaa，而 Compile 的回傳的是 aa)。字首有 Must 的函式表示，在解析正則語法的時候，如果匹配模式串不滿足正確的語法則直接 panic，而不加 Must 的則只是回傳錯誤。</p>

<p>在了解了如何建立一個 Regexp 之後，我們再來看一下這個 struct 提供了哪些方法來輔助我們操作字串，首先我們來看下面這些用來搜尋的函式：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">Find</span>(<span style="color:#a6e22e">b</span> []<span style="color:#66d9ef">byte</span>) []<span style="color:#66d9ef">byte</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindAll</span>(<span style="color:#a6e22e">b</span> []<span style="color:#66d9ef">byte</span>, <span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>) [][]<span style="color:#66d9ef">byte</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindAllIndex</span>(<span style="color:#a6e22e">b</span> []<span style="color:#66d9ef">byte</span>, <span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>) [][]<span style="color:#66d9ef">int</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindAllString</span>(<span style="color:#a6e22e">s</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>) []<span style="color:#66d9ef">string</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindAllStringIndex</span>(<span style="color:#a6e22e">s</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>) [][]<span style="color:#66d9ef">int</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindAllStringSubmatch</span>(<span style="color:#a6e22e">s</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>) [][]<span style="color:#66d9ef">string</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindAllStringSubmatchIndex</span>(<span style="color:#a6e22e">s</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>) [][]<span style="color:#66d9ef">int</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindAllSubmatch</span>(<span style="color:#a6e22e">b</span> []<span style="color:#66d9ef">byte</span>, <span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>) [][][]<span style="color:#66d9ef">byte</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindAllSubmatchIndex</span>(<span style="color:#a6e22e">b</span> []<span style="color:#66d9ef">byte</span>, <span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>) [][]<span style="color:#66d9ef">int</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindIndex</span>(<span style="color:#a6e22e">b</span> []<span style="color:#66d9ef">byte</span>) (<span style="color:#a6e22e">loc</span> []<span style="color:#66d9ef">int</span>)
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindReaderIndex</span>(<span style="color:#a6e22e">r</span> <span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">RuneReader</span>) (<span style="color:#a6e22e">loc</span> []<span style="color:#66d9ef">int</span>)
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindReaderSubmatchIndex</span>(<span style="color:#a6e22e">r</span> <span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">RuneReader</span>) []<span style="color:#66d9ef">int</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindString</span>(<span style="color:#a6e22e">s</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">string</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindStringIndex</span>(<span style="color:#a6e22e">s</span> <span style="color:#66d9ef">string</span>) (<span style="color:#a6e22e">loc</span> []<span style="color:#66d9ef">int</span>)
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindStringSubmatch</span>(<span style="color:#a6e22e">s</span> <span style="color:#66d9ef">string</span>) []<span style="color:#66d9ef">string</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindStringSubmatchIndex</span>(<span style="color:#a6e22e">s</span> <span style="color:#66d9ef">string</span>) []<span style="color:#66d9ef">int</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindSubmatch</span>(<span style="color:#a6e22e">b</span> []<span style="color:#66d9ef">byte</span>) [][]<span style="color:#66d9ef">byte</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindSubmatchIndex</span>(<span style="color:#a6e22e">b</span> []<span style="color:#66d9ef">byte</span>) []<span style="color:#66d9ef">int</span></code></pre></div>
<p>上面這 18 個函式我們根據輸入源(byte slice、string 和 io.RuneReader)不同還可以繼續簡化成如下幾個，其他的只是輸入源不一樣，其他功能基本是一樣的：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">Find</span>(<span style="color:#a6e22e">b</span> []<span style="color:#66d9ef">byte</span>) []<span style="color:#66d9ef">byte</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindAll</span>(<span style="color:#a6e22e">b</span> []<span style="color:#66d9ef">byte</span>, <span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>) [][]<span style="color:#66d9ef">byte</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindAllIndex</span>(<span style="color:#a6e22e">b</span> []<span style="color:#66d9ef">byte</span>, <span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>) [][]<span style="color:#66d9ef">int</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindAllSubmatch</span>(<span style="color:#a6e22e">b</span> []<span style="color:#66d9ef">byte</span>, <span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>) [][][]<span style="color:#66d9ef">byte</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindAllSubmatchIndex</span>(<span style="color:#a6e22e">b</span> []<span style="color:#66d9ef">byte</span>, <span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>) [][]<span style="color:#66d9ef">int</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindIndex</span>(<span style="color:#a6e22e">b</span> []<span style="color:#66d9ef">byte</span>) (<span style="color:#a6e22e">loc</span> []<span style="color:#66d9ef">int</span>)
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindSubmatch</span>(<span style="color:#a6e22e">b</span> []<span style="color:#66d9ef">byte</span>) [][]<span style="color:#66d9ef">byte</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">FindSubmatchIndex</span>(<span style="color:#a6e22e">b</span> []<span style="color:#66d9ef">byte</span>) []<span style="color:#66d9ef">int</span></code></pre></div>
<p>對於這些函式的使用我們來看下面這個例子</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;fmt&#34;</span>
	<span style="color:#e6db74">&#34;regexp&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#a6e22e">a</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">&#34;I am learning Go language&#34;</span>

	<span style="color:#a6e22e">re</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">regexp</span>.<span style="color:#a6e22e">Compile</span>(<span style="color:#e6db74">&#34;[a-z]{2,4}&#34;</span>)

	<span style="color:#75715e">//查詢符合正則的第一個
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">one</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">re</span>.<span style="color:#a6e22e">Find</span>([]byte(<span style="color:#a6e22e">a</span>))
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Find:&#34;</span>, string(<span style="color:#a6e22e">one</span>))

	<span style="color:#75715e">//查詢符合正則的所有 slice,n 小於 0 表示回傳全部符合的字串，不然就是回傳指定的長度
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">all</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">re</span>.<span style="color:#a6e22e">FindAll</span>([]byte(<span style="color:#a6e22e">a</span>), <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;FindAll&#34;</span>, <span style="color:#a6e22e">all</span>)

	<span style="color:#75715e">//查詢符合條件的 index 位置，開始位置和結束位置
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">index</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">re</span>.<span style="color:#a6e22e">FindIndex</span>([]byte(<span style="color:#a6e22e">a</span>))
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;FindIndex&#34;</span>, <span style="color:#a6e22e">index</span>)

	<span style="color:#75715e">//查詢符合條件的所有的 index 位置，n 同上
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">allindex</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">re</span>.<span style="color:#a6e22e">FindAllIndex</span>([]byte(<span style="color:#a6e22e">a</span>), <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;FindAllIndex&#34;</span>, <span style="color:#a6e22e">allindex</span>)

	<span style="color:#a6e22e">re2</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">regexp</span>.<span style="color:#a6e22e">Compile</span>(<span style="color:#e6db74">&#34;am(.*)lang(.*)&#34;</span>)

	<span style="color:#75715e">//查詢 Submatch，回傳陣列，第一個元素是匹配的全部元素，第二個元素是第一個()裡面的，第三個是第二個()裡面的
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//下面的輸出第一個元素是&#34;am learning Go language&#34;
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//第二個元素是&#34; learning Go &#34;，注意包含空格的輸出
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//第三個元素是&#34;uage&#34;
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">submatch</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">re2</span>.<span style="color:#a6e22e">FindSubmatch</span>([]byte(<span style="color:#a6e22e">a</span>))
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;FindSubmatch&#34;</span>, <span style="color:#a6e22e">submatch</span>)
	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">v</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">submatch</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(string(<span style="color:#a6e22e">v</span>))
	}

	<span style="color:#75715e">//定義和上面的 FindIndex 一樣
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">submatchindex</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">re2</span>.<span style="color:#a6e22e">FindSubmatchIndex</span>([]byte(<span style="color:#a6e22e">a</span>))
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">submatchindex</span>)

	<span style="color:#75715e">//FindAllSubmatch，查詢所有符合條件的子匹配
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">submatchall</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">re2</span>.<span style="color:#a6e22e">FindAllSubmatch</span>([]byte(<span style="color:#a6e22e">a</span>), <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">submatchall</span>)

	<span style="color:#75715e">//FindAllSubmatchIndex，查詢所有字匹配的 index
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">submatchallindex</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">re2</span>.<span style="color:#a6e22e">FindAllSubmatchIndex</span>([]byte(<span style="color:#a6e22e">a</span>), <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">submatchallindex</span>)
}</code></pre></div>
<p>前面介紹過匹配函式，Regexp 也定義了三個函式，它們和同名的外部函式功能一模一樣，其實外部函式就是呼叫了這 Regexp 的三個函式來實現的：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">Match</span>(<span style="color:#a6e22e">b</span> []<span style="color:#66d9ef">byte</span>) <span style="color:#66d9ef">bool</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">MatchReader</span>(<span style="color:#a6e22e">r</span> <span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">RuneReader</span>) <span style="color:#66d9ef">bool</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">MatchString</span>(<span style="color:#a6e22e">s</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">bool</span></code></pre></div>
<p>接下來讓我們來了解替換函式是怎麼操作的？</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">ReplaceAll</span>(<span style="color:#a6e22e">src</span>, <span style="color:#a6e22e">repl</span> []<span style="color:#66d9ef">byte</span>) []<span style="color:#66d9ef">byte</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">ReplaceAllFunc</span>(<span style="color:#a6e22e">src</span> []<span style="color:#66d9ef">byte</span>, <span style="color:#a6e22e">repl</span> <span style="color:#66d9ef">func</span>([]<span style="color:#66d9ef">byte</span>) []<span style="color:#66d9ef">byte</span>) []<span style="color:#66d9ef">byte</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">ReplaceAllLiteral</span>(<span style="color:#a6e22e">src</span>, <span style="color:#a6e22e">repl</span> []<span style="color:#66d9ef">byte</span>) []<span style="color:#66d9ef">byte</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">ReplaceAllLiteralString</span>(<span style="color:#a6e22e">src</span>, <span style="color:#a6e22e">repl</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">string</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">ReplaceAllString</span>(<span style="color:#a6e22e">src</span>, <span style="color:#a6e22e">repl</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">string</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">ReplaceAllStringFunc</span>(<span style="color:#a6e22e">src</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">repl</span> <span style="color:#66d9ef">func</span>(<span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">string</span></code></pre></div>
<p>這些替換函式我們在上面的抓網頁的例子有詳細應用範例，</p>

<p>接下來我們看一下 Expand 的解釋：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">Expand</span>(<span style="color:#a6e22e">dst</span> []<span style="color:#66d9ef">byte</span>, <span style="color:#a6e22e">template</span> []<span style="color:#66d9ef">byte</span>, <span style="color:#a6e22e">src</span> []<span style="color:#66d9ef">byte</span>, <span style="color:#a6e22e">match</span> []<span style="color:#66d9ef">int</span>) []<span style="color:#66d9ef">byte</span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">re</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Regexp</span>) <span style="color:#a6e22e">ExpandString</span>(<span style="color:#a6e22e">dst</span> []<span style="color:#66d9ef">byte</span>, <span style="color:#a6e22e">template</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">src</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">match</span> []<span style="color:#66d9ef">int</span>) []<span style="color:#66d9ef">byte</span></code></pre></div>
<p>那麼這個 Expand 到底用來幹嘛的呢？請看下面的例子：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#a6e22e">src</span> <span style="color:#f92672">:=</span> []byte(<span style="color:#e6db74">`
</span><span style="color:#e6db74">		call hello alice
</span><span style="color:#e6db74">		hello bob
</span><span style="color:#e6db74">		call hello eve
</span><span style="color:#e6db74">	`</span>)
	<span style="color:#a6e22e">pat</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">regexp</span>.<span style="color:#a6e22e">MustCompile</span>(<span style="color:#e6db74">`(?m)(call)\s+(?P&lt;cmd&gt;\w+)\s+(?P&lt;arg&gt;.+)\s*$`</span>)
	<span style="color:#a6e22e">res</span> <span style="color:#f92672">:=</span> []<span style="color:#66d9ef">byte</span>{}
	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">s</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">pat</span>.<span style="color:#a6e22e">FindAllSubmatchIndex</span>(<span style="color:#a6e22e">src</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) {
		<span style="color:#a6e22e">res</span> = <span style="color:#a6e22e">pat</span>.<span style="color:#a6e22e">Expand</span>(<span style="color:#a6e22e">res</span>, []byte(<span style="color:#e6db74">&#34;$cmd(&#39;$arg&#39;)\n&#34;</span>), <span style="color:#a6e22e">src</span>, <span style="color:#a6e22e">s</span>)
	}
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(string(<span style="color:#a6e22e">res</span>))
}</code></pre></div>
<p>至此我們已經全部介紹完 Go 語言的 <code>regexp</code> 套件，透過對它的主要函式介紹及示範，相信大家應該能夠透過 Go 語言的正則套件進行一些基本的正則的操作了。</p>

<h2 id="links">links</h2>

<ul>
<li><a href="docs/preface">目錄</a></li>
<li>上一節: <a href="docs/07.2">Json 處理</a></li>
<li>下一節: <a href="docs/07.4">範本處理</a></li>
</ul>
</article>

      
<div class="book-footer justify-between">
  
  <div>
    
    <a href="/commit/fda25aafea9413c8ec77f5df29d5f6bb5f7dc3a6" title='Last modified Sep 21, 2019 by Jiuxiao' target="_blank" rel="noopener">
      <img src="/buildWebWithGolangTw/svg/calendar.svg" alt="Changed" /> Sep 21, 2019
    </a>
  </div>
  
  
</div>


      
    </div>

    
  

  <aside class="book-toc level-3 fixed">
    <nav id="TableOfContents">
<ul>
<li><a href="#7-3-正則處理">7.3 正則處理</a>
<ul>
<li><a href="#透過正則判斷是否匹配">透過正則判斷是否匹配</a></li>
<li><a href="#透過正則取得內容">透過正則取得內容</a></li>
<li><a href="#links">links</a></li>
</ul></li>
</ul>
</nav>
  </aside>



  </main>

  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-148025936-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</body>

</html>
