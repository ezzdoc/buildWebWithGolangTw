<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>02.6 | 使用 Golang 打造 Web 應用程式</title>


<link rel="stylesheet" href="/buildWebWithGolangTw/book.min.89885fa0429ec73067282f26fc0c6d38cfc617a443ec4e835d47b821c52c6e92.css" integrity="sha256-iYhfoEKexzBnKC8m/AxtOM/GF6RD7E6DXUe4IcUsbpI=">


<script defer src="/buildWebWithGolangTw/search.min.4762838110f5450a8a33fcbe56c7ce734d09867f3e9ab5c1e6f7bbec99b65c68.js" integrity="sha256-R2KDgRD1RQqKM/y&#43;VsfOc00Jhn8&#43;mrXB5ve77Jm2XGg="></script>



<link rel="icon" href="/buildWebWithGolangTw/favicon.png" type="image/x-icon">

<base href="https://ezzdoc.com/buildWebWithGolangTw/">


<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav>
<h2 class="book-brand">
  <a href="https://ezzdoc.com/buildWebWithGolangTw/"><span>使用 Golang 打造 Web 應用程式</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" placeholder="Search" id="book-search-input" maxlength="64" readonly />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>





    
  
  
  

  <style>
  nav ul a[href$="\2f buildWebWithGolangTw\2f docs\2f 02.6\2f "] {
      color: #004ed0;
  }
  </style>

<ul>
<li><a href="/buildWebWithGolangTw/docs/preface/">目錄</a></li>
<li><a href="/buildWebWithGolangTw/docs/01.0/">1.Go 環境配置</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/01.1/">1.1 安裝 Go</a></li>
<li><a href="/buildWebWithGolangTw/docs/01.2/">1.2 GOPATH 與工作空間</a></li>
<li><a href="/buildWebWithGolangTw/docs/01.3/">1.3 Go 命令</a></li>
<li><a href="/buildWebWithGolangTw/docs/01.4/">1.4 Go 開發工具</a></li>
<li><a href="/buildWebWithGolangTw/docs/01.5/">1.5 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/02.0/">2.Go 語言基礎</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/02.1/">2.1 你好，Go</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.2/">2.2 Go 基礎</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.3/">2.3 流程和函式</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.4/">2.4 struct</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.5/">2.5 物件導向</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.6/">2.6 interface</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.7/">2.7 併發</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.8/">2.8 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/03.0/">3.Web 基礎</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/03.1/">3.1 web 工作方式</a></li>
<li><a href="/buildWebWithGolangTw/docs/03.2/">3.2 Go 建立一個簡單的 web 服務</a></li>
<li><a href="/buildWebWithGolangTw/docs/03.3/">3.3 Go 如何使得 web 工作</a></li>
<li><a href="/buildWebWithGolangTw/docs/03.4/">3.4 Go 的 http 套件詳解</a></li>
<li><a href="/buildWebWithGolangTw/docs/03.5/">3.5 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/04.0/">4.表單</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/04.1/">4.1 處理表單的輸入</a></li>
<li><a href="/buildWebWithGolangTw/docs/04.2/">4.2 驗證表單的輸入</a></li>
<li><a href="/buildWebWithGolangTw/docs/04.3/">4.3 預防跨站指令碼</a></li>
<li><a href="/buildWebWithGolangTw/docs/04.4/">4.4 防止多次提交表單</a></li>
<li><a href="/buildWebWithGolangTw/docs/04.5/">4.5 處理檔案上傳</a></li>
<li><a href="/buildWebWithGolangTw/docs/04.6/">4.6 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/05.0/">5.訪問資料庫</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/05.1/">5.1 database/sql 介面</a></li>
<li><a href="/buildWebWithGolangTw/docs/05.2/">5.2 使用 MySQL 資料庫</a></li>
<li><a href="/buildWebWithGolangTw/docs/05.3/">5.3 使用 SQLite 資料庫</a></li>
<li><a href="/buildWebWithGolangTw/docs/05.4/">5.4 使用 PostgreSQL 資料庫</a></li>
<li><a href="/buildWebWithGolangTw/docs/05.5/">5.5 使用 Beego orm 函式庫進行 ORM 開發</a></li>
<li><a href="/buildWebWithGolangTw/docs/05.6/">5.6 NOSQL 資料庫操作</a></li>
<li><a href="/buildWebWithGolangTw/docs/05.7/">5.7 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/06.0/">6.session 和資料儲存</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/06.1/">6.1 session 和 cookie</a></li>
<li><a href="/buildWebWithGolangTw/docs/06.2/">6.2 Go 如何使用 session</a></li>
<li><a href="/buildWebWithGolangTw/docs/06.3/">6.3 session 儲存</a></li>
<li><a href="/buildWebWithGolangTw/docs/06.4/">6.4 預防 session 劫持</a></li>
<li><a href="/buildWebWithGolangTw/docs/06.5/">6.5 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/07.0/">7.文字檔案處理</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/07.1/">7.1 XML 處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/07.2/">7.2 JSON 處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/07.3/">7.3 正則處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/07.4/">7.4 範本處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/07.5/">7.5 檔案操作</a></li>
<li><a href="/buildWebWithGolangTw/docs/07.6/">7.6 字串處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/07.7/">7.7 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/08.0/">8.Web 服務</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/08.1/">8.1 Socket 程式設計</a></li>
<li><a href="/buildWebWithGolangTw/docs/08.2/">8.2 WebSocket</a></li>
<li><a href="/buildWebWithGolangTw/docs/08.3/">8.3 REST</a></li>
<li><a href="/buildWebWithGolangTw/docs/08.4/">8.4 RPC</a></li>
<li><a href="/buildWebWithGolangTw/docs/08.5/">8.5 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/09.0/">9.安全與加密</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/09.1/">9.1 預防 CSRF 攻擊</a></li>
<li><a href="/buildWebWithGolangTw/docs/09.2/">9.2 確保輸入過濾</a></li>
<li><a href="/buildWebWithGolangTw/docs/09.3/">9.3 避免 XSS 攻擊</a></li>
<li><a href="/buildWebWithGolangTw/docs/09.4/">9.4 避免 SQL 注入</a></li>
<li><a href="/buildWebWithGolangTw/docs/09.5/">9.5 儲存密碼</a></li>
<li><a href="/buildWebWithGolangTw/docs/09.6/">9.6 加密和解密資料</a></li>
<li><a href="/buildWebWithGolangTw/docs/09.7/">9.7 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/10.0/">10.國際化和本地化</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/10.1/">10.1 設定預設地區</a></li>
<li><a href="/buildWebWithGolangTw/docs/10.2/">10.2 本地化資源</a></li>
<li><a href="/buildWebWithGolangTw/docs/10.3/">10.3 國際化站點</a></li>
<li><a href="/buildWebWithGolangTw/docs/10.4/">10.4 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/11.0/">11.錯誤處理，除錯和測試</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/11.1/">11.1 錯誤處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/11.2/">11.2 使用 GDB 除錯</a></li>
<li><a href="/buildWebWithGolangTw/docs/11.3/">11.3 Go 怎麼寫測試案例</a></li>
<li><a href="/buildWebWithGolangTw/docs/11.4/">11.4 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/12.0/">12.部署與維護</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/12.1/">12.1 應用日誌</a></li>
<li><a href="/buildWebWithGolangTw/docs/12.2/">12.2 網站錯誤處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/12.3/">12.3 應用部署</a></li>
<li><a href="/buildWebWithGolangTw/docs/12.4/">12.4 備份和還原</a></li>
<li><a href="/buildWebWithGolangTw/docs/12.5/">12.5 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/13.0/">13.如何設計一個 Web 框架</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/13.1/">13.1 專案規劃</a></li>
<li><a href="/buildWebWithGolangTw/docs/13.2/">13.2 自訂路由器設計</a></li>
<li><a href="/buildWebWithGolangTw/docs/13.3/">13.3 controller 設計</a></li>
<li><a href="/buildWebWithGolangTw/docs/13.4/">13.4 日誌和配置設計</a></li>
<li><a href="/buildWebWithGolangTw/docs/13.5/">13.5 實現部落格的增刪改</a></li>
<li><a href="/buildWebWithGolangTw/docs/13.6/">13.6 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/14.0/">14.擴充套件 Web 框架</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/14.1/">14.1 靜態檔案支援</a></li>
<li><a href="/buildWebWithGolangTw/docs/14.2/">14.2 Session 支援</a></li>
<li><a href="/buildWebWithGolangTw/docs/14.3/">14.3 表單支援</a></li>
<li><a href="/buildWebWithGolangTw/docs/14.4/">14.4 使用者認證</a></li>
<li><a href="/buildWebWithGolangTw/docs/14.5/">14.5 多語言支援</a></li>
<li><a href="/buildWebWithGolangTw/docs/14.6/">14.6 pprof 支援</a></li>
<li><a href="/buildWebWithGolangTw/docs/14.7/">14.7 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/ref/">附錄 A 參考資料</a></li>
</ul>







</nav>


<script>
(function() {
  var menu = document.querySelector("aside.book-menu nav");
  addEventListener("beforeunload", function(event) {
    localStorage.setItem("menu.scrollTop", menu.scrollTop);
  });
  menu.scrollTop = localStorage.getItem("menu.scrollTop");
})();
</script>

    </aside>

    <div class="book-page">
      <header class="flex align-center justify-between book-header">
  <label for="menu-control">
    <img src="/buildWebWithGolangTw/svg/menu.svg" alt="Menu" />
  </label>
  <strong>02.6</strong>
</header>

      
<article class="markdown">

<h1 id="2-6-interface">2.6 interface</h1>

<h2 id="interface">interface</h2>

<p>Go 語言裡面設計最精妙的應該算 interface，它讓物件導向，內容組織實現非常的方便，當你看完這一章，你就會被 interface 的巧妙設計所折服。</p>

<h3 id="什麼是-interface">什麼是 interface</h3>

<p>簡單的說，interface 是一組 method 簽名的組合，我們透過 interface 來定義物件的一組行為。</p>

<p>我們前面一章最後一個例子中 Student 和 Employee 都能 SayHi，雖然他們的內部實現不一樣，但是那不重要，重要的是他們都能<code>say hi</code></p>

<p>讓我們來繼續做更多的擴充套件，Student 和 Employee 實現另一個方法<code>Sing</code>，然後 Student 實現方法 BorrowMoney 而 Employee 實現 SpendSalary。</p>

<p>這樣 Student 實現了三個方法：SayHi、Sing、BorrowMoney；而 Employee 實現了 SayHi、Sing、SpendSalary。</p>

<p>上面這些方法的組合稱為 interface(被物件 Student 和 Employee 實現)。例如 Student 和 Employee 都實現了 interface：SayHi 和 Sing，也就是這兩個物件是該 interface 型別。而 Employee 沒有實現這個 interface：SayHi、Sing 和 BorrowMoney，因為 Employee 沒有實現 BorrowMoney 這個方法。</p>

<h3 id="interface-型別">interface 型別</h3>

<p>interface 型別定義了一組方法，如果某個物件實現了某個介面的所有方法，則此物件就實現了此介面。詳細的語法參考下面這個例子</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Human</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">age</span> <span style="color:#66d9ef">int</span>
	<span style="color:#a6e22e">phone</span> <span style="color:#66d9ef">string</span>
}

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Student</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">Human</span> <span style="color:#75715e">//匿名欄位 Human
</span><span style="color:#75715e"></span>
	<span style="color:#a6e22e">school</span> <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">loan</span> <span style="color:#66d9ef">float32</span>
}

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Employee</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">Human</span> <span style="color:#75715e">//匿名欄位 Human
</span><span style="color:#75715e"></span>
	<span style="color:#a6e22e">company</span> <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">money</span> <span style="color:#66d9ef">float32</span>
}

<span style="color:#75715e">//Human 物件實現 Sayhi 方法
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">h</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Human</span>) <span style="color:#a6e22e">SayHi</span>() {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Hi, I am %s you can call me on %s\n&#34;</span>, <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">phone</span>)
}

<span style="color:#75715e">// Human 物件實現 Sing 方法
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">h</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Human</span>) <span style="color:#a6e22e">Sing</span>(<span style="color:#a6e22e">lyrics</span> <span style="color:#66d9ef">string</span>) {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;La la, la la la, la la la la la...&#34;</span>, <span style="color:#a6e22e">lyrics</span>)
}

<span style="color:#75715e">//Human 物件實現 Guzzle 方法
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">h</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Human</span>) <span style="color:#a6e22e">Guzzle</span>(<span style="color:#a6e22e">beerStein</span> <span style="color:#66d9ef">string</span>) {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Guzzle Guzzle Guzzle...&#34;</span>, <span style="color:#a6e22e">beerStein</span>)
}

<span style="color:#75715e">// Employee 過載 Human 的 Sayhi 方法
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">e</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Employee</span>) <span style="color:#a6e22e">SayHi</span>() {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Hi, I am %s, I work at %s. Call me on %s\n&#34;</span>, <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">name</span>,
		<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">company</span>, <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">phone</span>) <span style="color:#75715e">//此句可以分成多行
</span><span style="color:#75715e"></span>}

<span style="color:#75715e">//Student 實現 BorrowMoney 方法
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Student</span>) <span style="color:#a6e22e">BorrowMoney</span>(<span style="color:#a6e22e">amount</span> <span style="color:#66d9ef">float32</span>) {
	<span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">loan</span> <span style="color:#f92672">+=</span> <span style="color:#a6e22e">amount</span> <span style="color:#75715e">// (again and again and...)
</span><span style="color:#75715e"></span>}

<span style="color:#75715e">//Employee 實現 SpendSalary 方法
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">e</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Employee</span>) <span style="color:#a6e22e">SpendSalary</span>(<span style="color:#a6e22e">amount</span> <span style="color:#66d9ef">float32</span>) {
	<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">money</span> <span style="color:#f92672">-=</span> <span style="color:#a6e22e">amount</span> <span style="color:#75715e">// More vodka please!!! Get me through the day!
</span><span style="color:#75715e"></span>}

<span style="color:#75715e">// 定義 interface
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Men</span> <span style="color:#66d9ef">interface</span> {
	<span style="color:#a6e22e">SayHi</span>()
	<span style="color:#a6e22e">Sing</span>(<span style="color:#a6e22e">lyrics</span> <span style="color:#66d9ef">string</span>)
	<span style="color:#a6e22e">Guzzle</span>(<span style="color:#a6e22e">beerStein</span> <span style="color:#66d9ef">string</span>)
}

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">YoungChap</span> <span style="color:#66d9ef">interface</span> {
	<span style="color:#a6e22e">SayHi</span>()
	<span style="color:#a6e22e">Sing</span>(<span style="color:#a6e22e">song</span> <span style="color:#66d9ef">string</span>)
	<span style="color:#a6e22e">BorrowMoney</span>(<span style="color:#a6e22e">amount</span> <span style="color:#66d9ef">float32</span>)
}

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ElderlyGent</span> <span style="color:#66d9ef">interface</span> {
	<span style="color:#a6e22e">SayHi</span>()
	<span style="color:#a6e22e">Sing</span>(<span style="color:#a6e22e">song</span> <span style="color:#66d9ef">string</span>)
	<span style="color:#a6e22e">SpendSalary</span>(<span style="color:#a6e22e">amount</span> <span style="color:#66d9ef">float32</span>)
}</code></pre></div>
<p>透過上面的程式碼我們可以知道，interface 可以被任意的物件實現。我們看到上面的 Men interface 被 Human、Student 和 Employee 實現。同理，一個物件可以實現任意多個 interface，例如上面的 Student 實現了 Men 和 YoungChap 兩個 interface。</p>

<p>最後，任意的型別都實現了空 interface(我們這樣定義：interface{})，也就是包含 0 個 method 的 interface。</p>

<h3 id="interface-值">interface 值</h3>

<p>那麼 interface 裡面到底能存什麼值呢？如果我們定義了一個 interface 的變數，那麼這個變數裡面可以存實現這個 interface 的任意型別的物件。例如上面例子中，我們定義了一個 Men interface 型別的變數 m，那麼 m 裡面可以存 Human、Student 或者 Employee 值。</p>

<p>因為 m 能夠持有這三種類型的物件，所以我們可以定義一個包含 Men 型別元素的 slice，這個 slice 可以被賦予實現了 Men 介面的任意結構的物件，這個和我們傳統意義上面的 slice 有所不同。</p>

<p>讓我們來看一下下面這個例子:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;fmt&#34;</span>

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Human</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">age</span> <span style="color:#66d9ef">int</span>
	<span style="color:#a6e22e">phone</span> <span style="color:#66d9ef">string</span>
}

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Student</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">Human</span> <span style="color:#75715e">//匿名欄位
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">school</span> <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">loan</span> <span style="color:#66d9ef">float32</span>
}

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Employee</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">Human</span> <span style="color:#75715e">//匿名欄位
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">company</span> <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">money</span> <span style="color:#66d9ef">float32</span>
}

<span style="color:#75715e">//Human 實現 SayHi 方法
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">h</span> <span style="color:#a6e22e">Human</span>) <span style="color:#a6e22e">SayHi</span>() {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Hi, I am %s you can call me on %s\n&#34;</span>, <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">phone</span>)
}

<span style="color:#75715e">//Human 實現 Sing 方法
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">h</span> <span style="color:#a6e22e">Human</span>) <span style="color:#a6e22e">Sing</span>(<span style="color:#a6e22e">lyrics</span> <span style="color:#66d9ef">string</span>) {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;La la la la...&#34;</span>, <span style="color:#a6e22e">lyrics</span>)
}

<span style="color:#75715e">//Employee 過載 Human 的 SayHi 方法
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">e</span> <span style="color:#a6e22e">Employee</span>) <span style="color:#a6e22e">SayHi</span>() {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Hi, I am %s, I work at %s. Call me on %s\n&#34;</span>, <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">name</span>,
		<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">company</span>, <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">phone</span>)
	}

<span style="color:#75715e">// Interface Men 被 Human,Student 和 Employee 實現
</span><span style="color:#75715e">// 因為這三個型別都實現了這兩個方法
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Men</span> <span style="color:#66d9ef">interface</span> {
	<span style="color:#a6e22e">SayHi</span>()
	<span style="color:#a6e22e">Sing</span>(<span style="color:#a6e22e">lyrics</span> <span style="color:#66d9ef">string</span>)
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#a6e22e">mike</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Student</span>{<span style="color:#a6e22e">Human</span>{<span style="color:#e6db74">&#34;Mike&#34;</span>, <span style="color:#ae81ff">25</span>, <span style="color:#e6db74">&#34;222-222-XXX&#34;</span>}, <span style="color:#e6db74">&#34;MIT&#34;</span>, <span style="color:#ae81ff">0.00</span>}
	<span style="color:#a6e22e">paul</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Student</span>{<span style="color:#a6e22e">Human</span>{<span style="color:#e6db74">&#34;Paul&#34;</span>, <span style="color:#ae81ff">26</span>, <span style="color:#e6db74">&#34;111-222-XXX&#34;</span>}, <span style="color:#e6db74">&#34;Harvard&#34;</span>, <span style="color:#ae81ff">100</span>}
	<span style="color:#a6e22e">sam</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Employee</span>{<span style="color:#a6e22e">Human</span>{<span style="color:#e6db74">&#34;Sam&#34;</span>, <span style="color:#ae81ff">36</span>, <span style="color:#e6db74">&#34;444-222-XXX&#34;</span>}, <span style="color:#e6db74">&#34;Golang Inc.&#34;</span>, <span style="color:#ae81ff">1000</span>}
	<span style="color:#a6e22e">tom</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Employee</span>{<span style="color:#a6e22e">Human</span>{<span style="color:#e6db74">&#34;Tom&#34;</span>, <span style="color:#ae81ff">37</span>, <span style="color:#e6db74">&#34;222-444-XXX&#34;</span>}, <span style="color:#e6db74">&#34;Things Ltd.&#34;</span>, <span style="color:#ae81ff">5000</span>}

	<span style="color:#75715e">//定義 Men 型別的變數 i
</span><span style="color:#75715e"></span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#a6e22e">Men</span>

	<span style="color:#75715e">//i 能儲存 Student
</span><span style="color:#75715e"></span>
	<span style="color:#a6e22e">i</span> = <span style="color:#a6e22e">mike</span>
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;This is Mike, a Student:&#34;</span>)
	<span style="color:#a6e22e">i</span>.<span style="color:#a6e22e">SayHi</span>()
	<span style="color:#a6e22e">i</span>.<span style="color:#a6e22e">Sing</span>(<span style="color:#e6db74">&#34;November rain&#34;</span>)

	<span style="color:#75715e">//i 也能儲存 Employee
</span><span style="color:#75715e"></span>
	<span style="color:#a6e22e">i</span> = <span style="color:#a6e22e">tom</span>
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;This is tom, an Employee:&#34;</span>)
	<span style="color:#a6e22e">i</span>.<span style="color:#a6e22e">SayHi</span>()
	<span style="color:#a6e22e">i</span>.<span style="color:#a6e22e">Sing</span>(<span style="color:#e6db74">&#34;Born to be wild&#34;</span>)

	<span style="color:#75715e">//定義了 slice Men
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Let&#39;s use a slice of Men and see what happens&#34;</span>)
	<span style="color:#a6e22e">x</span> <span style="color:#f92672">:=</span> make([]<span style="color:#a6e22e">Men</span>, <span style="color:#ae81ff">3</span>)
	<span style="color:#75715e">//這三個都是不同型別的元素，但是他們實現了 interface 同一個介面
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">x</span>[<span style="color:#ae81ff">0</span>], <span style="color:#a6e22e">x</span>[<span style="color:#ae81ff">1</span>], <span style="color:#a6e22e">x</span>[<span style="color:#ae81ff">2</span>] = <span style="color:#a6e22e">paul</span>, <span style="color:#a6e22e">sam</span>, <span style="color:#a6e22e">mike</span>

	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">value</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">x</span>{
		<span style="color:#a6e22e">value</span>.<span style="color:#a6e22e">SayHi</span>()
	}
}</code></pre></div>
<p>透過上面的程式碼，你會發現 interface 就是一組抽象方法的集合，它必須由其他非 interface 型別實現，而不能自我實現， Go 透過 interface 實現了 duck-typing:即&rdquo;當看到一隻鳥走起來像鴨子、游泳起來像鴨子、叫起來也像鴨子，那麼這隻鳥就可以被稱為鴨子&rdquo;。</p>

<h3 id="空-interface">空 interface</h3>

<p>空 interface(interface{})不包含任何的 method，正因為如此，所有的型別都實現了空 interface。空 interface 對於描述起不到任何的作用(因為它不包含任何的 method），但是空 interface 在我們需要儲存任意型別的數值的時候相當有用，因為它可以儲存任意型別的數值。它有點類似於 C 語言的 void*型別。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#75715e">// 定義 a 為空介面
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">a</span> <span style="color:#66d9ef">interface</span>{}
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#66d9ef">int</span> = <span style="color:#ae81ff">5</span>
<span style="color:#a6e22e">s</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">&#34;Hello world&#34;</span>
<span style="color:#75715e">// a 可以儲存任意型別的數值
</span><span style="color:#75715e"></span><span style="color:#a6e22e">a</span> = <span style="color:#a6e22e">i</span>
<span style="color:#a6e22e">a</span> = <span style="color:#a6e22e">s</span></code></pre></div>
<p>一個函式把 interface{} 作為參數，那麼他可以接受任意型別的值作為參數，如果一個函式回傳 interface{}，那麼也就可以回傳任意型別的值。是不是很有用啊！</p>

<h3 id="interface-函式參數">interface 函式參數</h3>

<p>interface 的變數可以持有任意實現該 interface 型別的物件，這給我們編寫函式(包括 method)提供了一些額外的思考，我們是不是可以透過定義 interface 參數，讓函式接受各種型別的參數。</p>

<p>舉個例子：fmt.Println 是我們常用的一個函式，但是你是否注意到它可以接受任意型別的資料。開啟 fmt 的原始碼檔案，你會看到這樣一個定義:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Stringer</span> <span style="color:#66d9ef">interface</span> {
	 <span style="color:#a6e22e">String</span>() <span style="color:#66d9ef">string</span>
}</code></pre></div>
<p>也就是說，任何實現了 String 方法的型別都能作為參數被 fmt.Println 呼叫，讓我們來試一試</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;fmt&#34;</span>
	<span style="color:#e6db74">&#34;strconv&#34;</span>
)

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Human</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">age</span> <span style="color:#66d9ef">int</span>
	<span style="color:#a6e22e">phone</span> <span style="color:#66d9ef">string</span>
}

<span style="color:#75715e">// 透過這個方法 Human 實現了 fmt.Stringer
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">h</span> <span style="color:#a6e22e">Human</span>) <span style="color:#a6e22e">String</span>() <span style="color:#66d9ef">string</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;❰&#34;</span><span style="color:#f92672">+</span><span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">name</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34; - &#34;</span><span style="color:#f92672">+</span><span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Itoa</span>(<span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">age</span>)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34; years -  ✆ &#34;</span> <span style="color:#f92672">+</span><span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">phone</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;❱&#34;</span>
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#a6e22e">Bob</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Human</span>{<span style="color:#e6db74">&#34;Bob&#34;</span>, <span style="color:#ae81ff">39</span>, <span style="color:#e6db74">&#34;000-7777-XXX&#34;</span>}
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;This Human is : &#34;</span>, <span style="color:#a6e22e">Bob</span>)
}</code></pre></div>
<p>現在我們再回顧一下前面的 Box 範例，你會發現 Color 結構也定義了一個 method：String。其實這也是實現了 fmt.Stringer 這個 interface，即如果需要某個型別能被 fmt 套件以特殊的格式輸出，你就必須實現 Stringer 這個介面。如果沒有實現這個介面，fmt 將以預設的方式輸出。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#75715e">//實現同樣的功能
</span><span style="color:#75715e"></span><span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;The biggest one is&#34;</span>, <span style="color:#a6e22e">boxes</span>.<span style="color:#a6e22e">BiggestsColor</span>().<span style="color:#a6e22e">String</span>())
<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;The biggest one is&#34;</span>, <span style="color:#a6e22e">boxes</span>.<span style="color:#a6e22e">BiggestsColor</span>())</code></pre></div>
<p>注：實現了 error 介面的物件（即實現了 Error() string 的物件），使用 fmt 輸出時，會呼叫 Error()方法，因此不必再定義 String()方法了。</p>

<h3 id="interface-變數儲存的型別">interface 變數儲存的型別</h3>

<p>我們知道 interface 的變數裡面可以儲存任意型別的數值(該型別實現了 interface)。那麼我們怎麼反向知道這個變數裡面實際儲存了的是哪個型別的物件呢？目前常用的有兩種方法：</p>

<ul>
<li><p>Comma-ok 斷言</p>

<p>Go 語言裡面有一個語法，可以直接判斷是否是該型別的變數： value, ok = element.(T)，這裡 value 就是變數的值，ok 是一個 bool 型別，element 是 interface 變數，T 是斷言的型別。</p>

<p>如果 element 裡面確實儲存了 T 型別的數值，那麼 ok 回傳 true，否則回傳 false。</p>

<p>讓我們透過一個例子來更加深入的理解。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go">	<span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

	<span style="color:#f92672">import</span> (
		<span style="color:#e6db74">&#34;fmt&#34;</span>
		<span style="color:#e6db74">&#34;strconv&#34;</span>
	)

	<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Element</span> <span style="color:#66d9ef">interface</span>{}
	<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">List</span> [] <span style="color:#a6e22e">Element</span>

	<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Person</span> <span style="color:#66d9ef">struct</span> {
		<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>
		<span style="color:#a6e22e">age</span> <span style="color:#66d9ef">int</span>
	}

	<span style="color:#75715e">//定義了 String 方法，實現了 fmt.Stringer
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#a6e22e">Person</span>) <span style="color:#a6e22e">String</span>() <span style="color:#66d9ef">string</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;(name: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">name</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; - age: &#34;</span><span style="color:#f92672">+</span><span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Itoa</span>(<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">age</span>)<span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; years)&#34;</span>
	}

	<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
		<span style="color:#a6e22e">list</span> <span style="color:#f92672">:=</span> make(<span style="color:#a6e22e">List</span>, <span style="color:#ae81ff">3</span>)
		<span style="color:#a6e22e">list</span>[<span style="color:#ae81ff">0</span>] = <span style="color:#ae81ff">1</span> <span style="color:#75715e">// an int
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">list</span>[<span style="color:#ae81ff">1</span>] = <span style="color:#e6db74">&#34;Hello&#34;</span> <span style="color:#75715e">// a string
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">list</span>[<span style="color:#ae81ff">2</span>] = <span style="color:#a6e22e">Person</span>{<span style="color:#e6db74">&#34;Dennis&#34;</span>, <span style="color:#ae81ff">70</span>}

		<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">index</span>, <span style="color:#a6e22e">element</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">list</span> {
			<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">value</span>, <span style="color:#a6e22e">ok</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">element</span>.(<span style="color:#66d9ef">int</span>); <span style="color:#a6e22e">ok</span> {
				<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;list[%d] is an int and its value is %d\n&#34;</span>, <span style="color:#a6e22e">index</span>, <span style="color:#a6e22e">value</span>)
			} <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">value</span>, <span style="color:#a6e22e">ok</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">element</span>.(<span style="color:#66d9ef">string</span>); <span style="color:#a6e22e">ok</span> {
				<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;list[%d] is a string and its value is %s\n&#34;</span>, <span style="color:#a6e22e">index</span>, <span style="color:#a6e22e">value</span>)
			} <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">value</span>, <span style="color:#a6e22e">ok</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">element</span>.(<span style="color:#a6e22e">Person</span>); <span style="color:#a6e22e">ok</span> {
				<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;list[%d] is a Person and its value is %s\n&#34;</span>, <span style="color:#a6e22e">index</span>, <span style="color:#a6e22e">value</span>)
			} <span style="color:#66d9ef">else</span> {
				<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;list[%d] is of a different type\n&#34;</span>, <span style="color:#a6e22e">index</span>)
			}
		}
	}</code></pre></div>
<p>是不是很簡單啊，同時你是否注意到了多個 if 裡面，還記得我前面介紹流程時講過，if 裡面允許初始化變數。</p>

<p>也許你注意到了，我們斷言的型別越多，那麼 if else 也就越多，所以才引出了下面要介紹的 switch。</p></li>

<li><p>switch 測試</p>

<p>最好的講解就是程式碼例子，現在讓我們重寫上面的這個實現</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go">	<span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

	<span style="color:#f92672">import</span> (
		<span style="color:#e6db74">&#34;fmt&#34;</span>
		<span style="color:#e6db74">&#34;strconv&#34;</span>
	)

	<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Element</span> <span style="color:#66d9ef">interface</span>{}
	<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">List</span> [] <span style="color:#a6e22e">Element</span>

	<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Person</span> <span style="color:#66d9ef">struct</span> {
		<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>
		<span style="color:#a6e22e">age</span> <span style="color:#66d9ef">int</span>
	}

	<span style="color:#75715e">//列印
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#a6e22e">Person</span>) <span style="color:#a6e22e">String</span>() <span style="color:#66d9ef">string</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;(name: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">name</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; - age: &#34;</span><span style="color:#f92672">+</span><span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Itoa</span>(<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">age</span>)<span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; years)&#34;</span>
	}

	<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
		<span style="color:#a6e22e">list</span> <span style="color:#f92672">:=</span> make(<span style="color:#a6e22e">List</span>, <span style="color:#ae81ff">3</span>)
		<span style="color:#a6e22e">list</span>[<span style="color:#ae81ff">0</span>] = <span style="color:#ae81ff">1</span> <span style="color:#75715e">//an int
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">list</span>[<span style="color:#ae81ff">1</span>] = <span style="color:#e6db74">&#34;Hello&#34;</span> <span style="color:#75715e">//a string
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">list</span>[<span style="color:#ae81ff">2</span>] = <span style="color:#a6e22e">Person</span>{<span style="color:#e6db74">&#34;Dennis&#34;</span>, <span style="color:#ae81ff">70</span>}

		<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">index</span>, <span style="color:#a6e22e">element</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">list</span>{
			<span style="color:#66d9ef">switch</span> <span style="color:#a6e22e">value</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">element</span>.(<span style="color:#66d9ef">type</span>) {
				<span style="color:#66d9ef">case</span> <span style="color:#66d9ef">int</span>:
					<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;list[%d] is an int and its value is %d\n&#34;</span>, <span style="color:#a6e22e">index</span>, <span style="color:#a6e22e">value</span>)
				<span style="color:#66d9ef">case</span> <span style="color:#66d9ef">string</span>:
					<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;list[%d] is a string and its value is %s\n&#34;</span>, <span style="color:#a6e22e">index</span>, <span style="color:#a6e22e">value</span>)
				<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">Person</span>:
					<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;list[%d] is a Person and its value is %s\n&#34;</span>, <span style="color:#a6e22e">index</span>, <span style="color:#a6e22e">value</span>)
				<span style="color:#66d9ef">default</span>:
					<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;list[%d] is of a different type&#34;</span>, <span style="color:#a6e22e">index</span>)
			}
		}
	}</code></pre></div>
<p>這裡有一點需要強調的是：<code>element.(type)</code>語法不能在 switch 外的任何邏輯裡面使用，如果你要在 switch 外面判斷一個型別就使用<code>comma-ok</code>。</p></li>
</ul>

<h3 id="嵌入-interface">嵌入 interface</h3>

<p>Go 裡面真正吸引人的是它內建的邏輯語法，就像我們在學習 Struct 時學習的匿名欄位，多麼的優雅啊，那麼相同的邏輯引入到 interface 裡面，那不是更加完美了。如果一個 interface1 作為 interface2 的一個嵌入欄位，那麼 interface2 隱式的包含了 interface1 裡面的 method。</p>

<p>我們可以看到原始碼套件 container/heap 裡面有這樣的一個定義</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Interface</span> <span style="color:#66d9ef">interface</span> {
	<span style="color:#a6e22e">sort</span>.<span style="color:#a6e22e">Interface</span> <span style="color:#75715e">//嵌入欄位 sort.Interface
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Push</span>(<span style="color:#a6e22e">x</span> <span style="color:#66d9ef">interface</span>{}) <span style="color:#75715e">//a Push method to push elements into the heap
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Pop</span>() <span style="color:#66d9ef">interface</span>{} <span style="color:#75715e">//a Pop elements that pops elements from the heap
</span><span style="color:#75715e"></span>}</code></pre></div>
<p>我們看到 sort.Interface 其實就是嵌入欄位，把 sort.Interface 的所有 method 給隱式的包含進來了。也就是下面三個方法：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Interface</span> <span style="color:#66d9ef">interface</span> {
	<span style="color:#75715e">// Len is the number of elements in the collection.
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Len</span>() <span style="color:#66d9ef">int</span>
	<span style="color:#75715e">// Less returns whether the element with index i should sort
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// before the element with index j.
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Less</span>(<span style="color:#a6e22e">i</span>, <span style="color:#a6e22e">j</span> <span style="color:#66d9ef">int</span>) <span style="color:#66d9ef">bool</span>
	<span style="color:#75715e">// Swap swaps the elements with indexes i and j.
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Swap</span>(<span style="color:#a6e22e">i</span>, <span style="color:#a6e22e">j</span> <span style="color:#66d9ef">int</span>)
}</code></pre></div>
<p>另一個例子就是 io 套件下面的 io.ReadWriter ，它包含了 io 套件下面的 Reader 和 Writer 兩個 interface：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#75715e">// io.ReadWriter
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ReadWriter</span> <span style="color:#66d9ef">interface</span> {
	<span style="color:#a6e22e">Reader</span>
	<span style="color:#a6e22e">Writer</span>
}</code></pre></div>
<h3 id="反射">反射</h3>

<p>Go 語言實現了反射，所謂反射就是能檢查程式在執行時的狀態。我們一般用到的套件是 reflect 套件。如何運用 reflect 套件，官方的這篇文章詳細的講解了 reflect 套件的實現原理，<a href="http://golang.org/doc/articles/laws_of_reflection.html">laws of reflection</a></p>

<p>使用 reflect 一般分成三步，下面簡要的講解一下：要去反射是一個型別的值(這些值都實現了空 interface)，首先需要把它轉化成 reflect 物件(reflect.Type 或者 reflect.Value，根據不同的情況呼叫不同的函式)。這兩種取得方式如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#a6e22e">t</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">reflect</span>.<span style="color:#a6e22e">TypeOf</span>(<span style="color:#a6e22e">i</span>)    <span style="color:#75715e">//得到型別的 Meta 資料，透過 t 我們能取得型別定義裡面的所有元素
</span><span style="color:#75715e"></span><span style="color:#a6e22e">v</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">reflect</span>.<span style="color:#a6e22e">ValueOf</span>(<span style="color:#a6e22e">i</span>)   <span style="color:#f92672">//</span><span style="color:#a6e22e">得到實際的值</span><span style="color:#960050;background-color:#1e0010">，</span><span style="color:#a6e22e">透過</span> <span style="color:#a6e22e">v</span> <span style="color:#a6e22e">我們取得儲存在裡面的值</span><span style="color:#960050;background-color:#1e0010">，</span><span style="color:#a6e22e">還可以去改變值</span></code></pre></div>
<p>轉化為 reflect 物件之後我們就可以進行一些操作了，也就是將 reflect 物件轉化成相應的值，例如</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#a6e22e">tag</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Elem</span>().<span style="color:#a6e22e">Field</span>(<span style="color:#ae81ff">0</span>).<span style="color:#a6e22e">Tag</span>  <span style="color:#75715e">//取得定義在 struct 裡面的標籤
</span><span style="color:#75715e"></span><span style="color:#a6e22e">name</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">Elem</span>().<span style="color:#a6e22e">Field</span>(<span style="color:#ae81ff">0</span>).<span style="color:#a6e22e">String</span>()  <span style="color:#f92672">//</span><span style="color:#a6e22e">取得儲存在第一個欄位裡面的值</span></code></pre></div>
<p>取得反射值能回傳相應的型別和數值</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">x</span> <span style="color:#66d9ef">float64</span> = <span style="color:#ae81ff">3.4</span>
<span style="color:#a6e22e">v</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">reflect</span>.<span style="color:#a6e22e">ValueOf</span>(<span style="color:#a6e22e">x</span>)
<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;type:&#34;</span>, <span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">Type</span>())
<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;kind is float64:&#34;</span>, <span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">Kind</span>() <span style="color:#f92672">==</span> <span style="color:#a6e22e">reflect</span>.<span style="color:#a6e22e">Float64</span>)
<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;value:&#34;</span>, <span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">Float</span>())</code></pre></div>
<p>最後，反射的話，那麼反射的欄位必須是可修改的，我們前面學習過傳值和傳參考，這個裡面也是一樣的道理。反射的欄位必須是可讀寫的意思是，如果下面這樣寫，那麼會發生錯誤</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">x</span> <span style="color:#66d9ef">float64</span> = <span style="color:#ae81ff">3.4</span>
<span style="color:#a6e22e">v</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">reflect</span>.<span style="color:#a6e22e">ValueOf</span>(<span style="color:#a6e22e">x</span>)
<span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">SetFloat</span>(<span style="color:#ae81ff">7.1</span>)</code></pre></div>
<p>如果要修改相應的值，必須這樣寫</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">x</span> <span style="color:#66d9ef">float64</span> = <span style="color:#ae81ff">3.4</span>
<span style="color:#a6e22e">p</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">reflect</span>.<span style="color:#a6e22e">ValueOf</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">x</span>)
<span style="color:#a6e22e">v</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">Elem</span>()
<span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">SetFloat</span>(<span style="color:#ae81ff">7.1</span>)</code></pre></div>
<p>上面只是對反射的簡單介紹，更深入的理解還需要自己在程式設計中不斷的實踐。</p>

<h2 id="links">links</h2>

<ul>
<li><a href="docs/preface">目錄</a></li>
<li>上一章: <a href="docs/02.5">物件導向</a></li>
<li>下一節: <a href="docs/02.7">併發</a></li>
</ul>
</article>

      
<div class="book-footer justify-between">
  
  <div>
    
    <a href="/commit/fda25aafea9413c8ec77f5df29d5f6bb5f7dc3a6" title='Last modified Sep 21, 2019 by Jiuxiao' target="_blank" rel="noopener">
      <img src="/buildWebWithGolangTw/svg/calendar.svg" alt="Changed" /> Sep 21, 2019
    </a>
  </div>
  
  
</div>


      
    </div>

    
  

  <aside class="book-toc level-3 fixed">
    <nav id="TableOfContents">
<ul>
<li><a href="#2-6-interface">2.6 interface</a>
<ul>
<li><a href="#interface">interface</a>
<ul>
<li><a href="#什麼是-interface">什麼是 interface</a></li>
<li><a href="#interface-型別">interface 型別</a></li>
<li><a href="#interface-值">interface 值</a></li>
<li><a href="#空-interface">空 interface</a></li>
<li><a href="#interface-函式參數">interface 函式參數</a></li>
<li><a href="#interface-變數儲存的型別">interface 變數儲存的型別</a></li>
<li><a href="#嵌入-interface">嵌入 interface</a></li>
<li><a href="#反射">反射</a></li>
</ul></li>
<li><a href="#links">links</a></li>
</ul></li>
</ul>
</nav>
  </aside>



  </main>

  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-148025936-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</body>

</html>
