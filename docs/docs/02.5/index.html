<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>02.5 | 使用 Golang 打造 Web 應用程式</title>


<link rel="stylesheet" href="/buildWebWithGolangTw/book.min.89885fa0429ec73067282f26fc0c6d38cfc617a443ec4e835d47b821c52c6e92.css" integrity="sha256-iYhfoEKexzBnKC8m/AxtOM/GF6RD7E6DXUe4IcUsbpI=">


<script defer src="/buildWebWithGolangTw/search.min.1a26f030063cd84b7dd0472b3e255bc21c62c31322ab49b56f536fba41b42496.js" integrity="sha256-GibwMAY82Et90EcrPiVbwhxiwxMiq0m1b1NvukG0JJY="></script>



<link rel="icon" href="/buildWebWithGolangTw/favicon.png" type="image/x-icon">

<base href="https://ezzdoc.com/buildWebWithGolangTw/">


<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav>
<h2 class="book-brand">
  <a href="https://ezzdoc.com/buildWebWithGolangTw/"><span>使用 Golang 打造 Web 應用程式</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" placeholder="Search" id="book-search-input" maxlength="64" readonly />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>





    
  
  
  

  <style>
  nav ul a[href$="\2f buildWebWithGolangTw\2f docs\2f 02.5\2f "] {
      color: #004ed0;
  }
  </style>

<ul>
<li><a href="/buildWebWithGolangTw/docs/preface/">目錄</a></li>
<li><a href="/buildWebWithGolangTw/docs/01.0/">1.Go 環境配置</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/01.1/">1.1 安裝 Go</a></li>
<li><a href="/buildWebWithGolangTw/docs/01.2/">1.2 GOPATH 與工作空間</a></li>
<li><a href="/buildWebWithGolangTw/docs/01.3/">1.3 Go 命令</a></li>
<li><a href="/buildWebWithGolangTw/docs/01.4/">1.4 Go 開發工具</a></li>
<li><a href="/buildWebWithGolangTw/docs/01.5/">1.5 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/02.0/">2.Go 語言基礎</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/02.1/">2.1 你好，Go</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.2/">2.2 Go 基礎</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.3/">2.3 流程和函式</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.4/">2.4 struct</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.5/">2.5 物件導向</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.6/">2.6 interface</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.7/">2.7 併發</a></li>
<li><a href="/buildWebWithGolangTw/docs/02.8/">2.8 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/03.0/">3.Web 基礎</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/03.1/">3.1 web 工作方式</a></li>
<li><a href="/buildWebWithGolangTw/docs/03.2/">3.2 Go 建立一個簡單的 web 服務</a></li>
<li><a href="/buildWebWithGolangTw/docs/03.3/">3.3 Go 如何使得 web 工作</a></li>
<li><a href="/buildWebWithGolangTw/docs/03.4/">3.4 Go 的 http 套件詳解</a></li>
<li><a href="/buildWebWithGolangTw/docs/03.5/">3.5 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/04.0/">4.表單</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/04.1/">4.1 處理表單的輸入</a></li>
<li><a href="/buildWebWithGolangTw/docs/04.2/">4.2 驗證表單的輸入</a></li>
<li><a href="/buildWebWithGolangTw/docs/04.3/">4.3 預防跨站指令碼</a></li>
<li><a href="/buildWebWithGolangTw/docs/04.4/">4.4 防止多次提交表單</a></li>
<li><a href="/buildWebWithGolangTw/docs/04.5/">4.5 處理檔案上傳</a></li>
<li><a href="/buildWebWithGolangTw/docs/04.6/">4.6 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/05.0/">5.訪問資料庫</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/05.1/">5.1 database/sql 介面</a></li>
<li><a href="/buildWebWithGolangTw/docs/05.2/">5.2 使用 MySQL 資料庫</a></li>
<li><a href="/buildWebWithGolangTw/docs/05.3/">5.3 使用 SQLite 資料庫</a></li>
<li><a href="/buildWebWithGolangTw/docs/05.4/">5.4 使用 PostgreSQL 資料庫</a></li>
<li><a href="/buildWebWithGolangTw/docs/05.5/">5.5 使用 Beego orm 函式庫進行 ORM 開發</a></li>
<li><a href="/buildWebWithGolangTw/docs/05.6/">5.6 NOSQL 資料庫操作</a></li>
<li><a href="/buildWebWithGolangTw/docs/05.7/">5.7 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/06.0/">6.session 和資料儲存</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/06.1/">6.1 session 和 cookie</a></li>
<li><a href="/buildWebWithGolangTw/docs/06.2/">6.2 Go 如何使用 session</a></li>
<li><a href="/buildWebWithGolangTw/docs/06.3/">6.3 session 儲存</a></li>
<li><a href="/buildWebWithGolangTw/docs/06.4/">6.4 預防 session 劫持</a></li>
<li><a href="/buildWebWithGolangTw/docs/06.5/">6.5 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/07.0/">7.文字檔案處理</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/07.1/">7.1 XML 處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/07.2/">7.2 JSON 處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/07.3/">7.3 正則處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/07.4/">7.4 範本處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/07.5/">7.5 檔案操作</a></li>
<li><a href="/buildWebWithGolangTw/docs/07.6/">7.6 字串處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/07.7/">7.7 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/08.0/">8.Web 服務</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/08.1/">8.1 Socket 程式設計</a></li>
<li><a href="/buildWebWithGolangTw/docs/08.2/">8.2 WebSocket</a></li>
<li><a href="/buildWebWithGolangTw/docs/08.3/">8.3 REST</a></li>
<li><a href="/buildWebWithGolangTw/docs/08.4/">8.4 RPC</a></li>
<li><a href="/buildWebWithGolangTw/docs/08.5/">8.5 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/09.0/">9.安全與加密</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/09.1/">9.1 預防 CSRF 攻擊</a></li>
<li><a href="/buildWebWithGolangTw/docs/09.2/">9.2 確保輸入過濾</a></li>
<li><a href="/buildWebWithGolangTw/docs/09.3/">9.3 避免 XSS 攻擊</a></li>
<li><a href="/buildWebWithGolangTw/docs/09.4/">9.4 避免 SQL 注入</a></li>
<li><a href="/buildWebWithGolangTw/docs/09.5/">9.5 儲存密碼</a></li>
<li><a href="/buildWebWithGolangTw/docs/09.6/">9.6 加密和解密資料</a></li>
<li><a href="/buildWebWithGolangTw/docs/09.7/">9.7 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/10.0/">10.國際化和本地化</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/10.1/">10.1 設定預設地區</a></li>
<li><a href="/buildWebWithGolangTw/docs/10.2/">10.2 本地化資源</a></li>
<li><a href="/buildWebWithGolangTw/docs/10.3/">10.3 國際化站點</a></li>
<li><a href="/buildWebWithGolangTw/docs/10.4/">10.4 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/11.0/">11.錯誤處理，除錯和測試</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/11.1/">11.1 錯誤處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/11.2/">11.2 使用 GDB 除錯</a></li>
<li><a href="/buildWebWithGolangTw/docs/11.3/">11.3 Go 怎麼寫測試案例</a></li>
<li><a href="/buildWebWithGolangTw/docs/11.4/">11.4 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/12.0/">12.部署與維護</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/12.1/">12.1 應用日誌</a></li>
<li><a href="/buildWebWithGolangTw/docs/12.2/">12.2 網站錯誤處理</a></li>
<li><a href="/buildWebWithGolangTw/docs/12.3/">12.3 應用部署</a></li>
<li><a href="/buildWebWithGolangTw/docs/12.4/">12.4 備份和還原</a></li>
<li><a href="/buildWebWithGolangTw/docs/12.5/">12.5 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/13.0/">13.如何設計一個 Web 框架</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/13.1/">13.1 專案規劃</a></li>
<li><a href="/buildWebWithGolangTw/docs/13.2/">13.2 自訂路由器設計</a></li>
<li><a href="/buildWebWithGolangTw/docs/13.3/">13.3 controller 設計</a></li>
<li><a href="/buildWebWithGolangTw/docs/13.4/">13.4 日誌和配置設計</a></li>
<li><a href="/buildWebWithGolangTw/docs/13.5/">13.5 實現部落格的增刪改</a></li>
<li><a href="/buildWebWithGolangTw/docs/13.6/">13.6 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/14.0/">14.擴充套件 Web 框架</a>

<ul>
<li><a href="/buildWebWithGolangTw/docs/14.1/">14.1 靜態檔案支援</a></li>
<li><a href="/buildWebWithGolangTw/docs/14.2/">14.2 Session 支援</a></li>
<li><a href="/buildWebWithGolangTw/docs/14.3/">14.3 表單支援</a></li>
<li><a href="/buildWebWithGolangTw/docs/14.4/">14.4 使用者認證</a></li>
<li><a href="/buildWebWithGolangTw/docs/14.5/">14.5 多語言支援</a></li>
<li><a href="/buildWebWithGolangTw/docs/14.6/">14.6 pprof 支援</a></li>
<li><a href="/buildWebWithGolangTw/docs/14.7/">14.7 小結</a></li>
</ul></li>
<li><a href="/buildWebWithGolangTw/docs/ref/">附錄 A 參考資料</a></li>
</ul>







</nav>


<script>
(function() {
  var menu = document.querySelector("aside.book-menu nav");
  addEventListener("beforeunload", function(event) {
    localStorage.setItem("menu.scrollTop", menu.scrollTop);
  });
  menu.scrollTop = localStorage.getItem("menu.scrollTop");
})();
</script>

    </aside>

    <div class="book-page">
      <header class="flex align-center justify-between book-header">
  <label for="menu-control">
    <img src="/buildWebWithGolangTw/svg/menu.svg" alt="Menu" />
  </label>
  <strong>02.5</strong>
</header>

      
<article class="markdown">

<h1 id="2-5-物件導向">2.5 物件導向</h1>

<p>前面兩章我們介紹了函式和 struct，那你是否想過函式當作 struct 的欄位一樣來處理呢？今天我們就講解一下函式的另一種形態，帶有接收者的函式，我們稱為<code>method</code></p>

<h2 id="method">method</h2>

<p>現在假設有這麼一個場景，你定義了一個 struct 叫做長方形，你現在想要計算他的面積，那麼按照我們一般的思路應該會用下面的方式來實現</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;fmt&#34;</span>

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Rectangle</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">width</span>, <span style="color:#a6e22e">height</span> <span style="color:#66d9ef">float64</span>
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">area</span>(<span style="color:#a6e22e">r</span> <span style="color:#a6e22e">Rectangle</span>) <span style="color:#66d9ef">float64</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">width</span><span style="color:#f92672">*</span><span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">height</span>
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#a6e22e">r1</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Rectangle</span>{<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">2</span>}
	<span style="color:#a6e22e">r2</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Rectangle</span>{<span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">4</span>}
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Area of r1 is: &#34;</span>, <span style="color:#a6e22e">area</span>(<span style="color:#a6e22e">r1</span>))
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Area of r2 is: &#34;</span>, <span style="color:#a6e22e">area</span>(<span style="color:#a6e22e">r2</span>))
}</code></pre></div>
<p>這段程式碼可以計算出來長方形的面積，但是 area()不是作為 Rectangle 的方法實現的（類似物件導向裡面的方法），而是將 Rectangle 的物件（如 r1,r2）作為參數傳入函式計算面積的。</p>

<p>這樣實現當然沒有問題囉，但是當需要增加圓形、正方形、五邊形甚至其它多邊形的時候，你想計算他們的面積的時候怎麼辦啊？那就只能增加新的函式囉，但是函式名你就必須要跟著換了，變成<code>area_rectangle, area_circle, area_triangle...</code></p>

<p>像下圖所表示的那樣， 橢圓代表函式, 而這些函式並不從屬於 struct(或者以物件導向的術語來說，並不屬於 class)，他們是單獨存在於 struct 外圍，而非在概念上屬於某個 struct 的。</p>

<p><img src="images/2.5.rect_func_without_receiver.png" alt="" /></p>

<p>圖 2.8 方法和 struct 的關係圖</p>

<p>很顯然，這樣的實現並不優雅，並且從概念上來說&rdquo;面積&rdquo;是&rdquo;形狀&rdquo;的一個屬性，它是屬於這個特定的形狀的，就像長方形的長和寬一樣。</p>

<p>基於上面的原因所以就有了 <code>method</code> 的概念，<code>method</code>是附屬在一個給定的型別上的，他的語法和函式的宣告語法幾乎一樣，只是在 <code>func</code> 後面增加了一個 receiver (也就是 method 所依從的主體)。</p>

<p>用上面提到的形狀的例子來說，method <code>area()</code> 是依賴於某個形狀(比如說 Rectangle)來發生作用的。Rectangle.area()的發出者是 Rectangle， area()是屬於 Rectangle 的方法，而非一個外圍函式。</p>

<p>更具體地說，Rectangle 存在欄位 height 和 width, 同時存在方法 area(), 這些欄位和方法都屬於 Rectangle。</p>

<p>用 Rob Pike 的話來說就是：</p>

<blockquote>
<p>&ldquo;A method is a function with an implicit first argument, called a receiver.&rdquo;</p>
</blockquote>

<p>method 的語法如下：</p>

<pre><code>func (r ReceiverType) funcName(parameters) (results)
</code></pre>

<p>下面我們用最開始的例子用 method 來實現：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;fmt&#34;</span>
	<span style="color:#e6db74">&#34;math&#34;</span>
)

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Rectangle</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">width</span>, <span style="color:#a6e22e">height</span> <span style="color:#66d9ef">float64</span>
}

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Circle</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">radius</span> <span style="color:#66d9ef">float64</span>
}

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">r</span> <span style="color:#a6e22e">Rectangle</span>) <span style="color:#a6e22e">area</span>() <span style="color:#66d9ef">float64</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">width</span><span style="color:#f92672">*</span><span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">height</span>
}

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">c</span> <span style="color:#a6e22e">Circle</span>) <span style="color:#a6e22e">area</span>() <span style="color:#66d9ef">float64</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">radius</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">radius</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">math</span>.<span style="color:#a6e22e">Pi</span>
}


<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#a6e22e">r1</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Rectangle</span>{<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">2</span>}
	<span style="color:#a6e22e">r2</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Rectangle</span>{<span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">4</span>}
	<span style="color:#a6e22e">c1</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Circle</span>{<span style="color:#ae81ff">10</span>}
	<span style="color:#a6e22e">c2</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Circle</span>{<span style="color:#ae81ff">25</span>}

	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Area of r1 is: &#34;</span>, <span style="color:#a6e22e">r1</span>.<span style="color:#a6e22e">area</span>())
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Area of r2 is: &#34;</span>, <span style="color:#a6e22e">r2</span>.<span style="color:#a6e22e">area</span>())
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Area of c1 is: &#34;</span>, <span style="color:#a6e22e">c1</span>.<span style="color:#a6e22e">area</span>())
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Area of c2 is: &#34;</span>, <span style="color:#a6e22e">c2</span>.<span style="color:#a6e22e">area</span>())
}</code></pre></div>
<p>在使用 method 的時候重要注意幾點</p>

<ul>
<li>雖然 method 的名字一模一樣，但是如果接收者不一樣，那麼 method 就不一樣</li>
<li>method 裡面可以訪問接收者的欄位</li>
<li>呼叫 method 透過<code>.</code>訪問，就像 struct 裡面訪問欄位一樣</li>
</ul>

<p>圖示如下:</p>

<p><img src="images/2.5.shapes_func_with_receiver_cp.png" alt="" /></p>

<p>圖 2.9 不同 struct 的 method 不同</p>

<p>在上例，method area() 分別屬於 Rectangle 和 Circle， 於是他們的 Receiver 就變成了 Rectangle 和 Circle, 或者說，這個 area()方法 是由 Rectangle/Circle 發出的。</p>

<blockquote>
<p>值得說明的一點是，圖示中 method 用虛線標出，意思是此處方法的 Receiver 是以值傳遞，而非參考傳遞，是的，Receiver 還可以是指標, 兩者的差別在於, 指標作為 Receiver 會對實體物件的內容發生操作，而普通型別作為 Receiver 僅僅是以副本作為操作物件，並不對原實體物件發生操作。後文對此會有詳細論述。</p>
</blockquote>

<p>那是不是 method 只能作用在 struct 上面呢？當然不是囉，他可以定義在任何你自訂的型別、內建型別、struct 等各種型別上面。這裡你是不是有點迷糊了，什麼叫自訂型別，自訂型別不就是 struct 嘛，不是這樣的哦，struct 只是自訂型別裡面一種比較特殊的型別而已，還有其他自訂型別宣告，可以透過如下這樣的宣告來實現。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">typeName</span> <span style="color:#a6e22e">typeLiteral</span></code></pre></div>
<p>請看下面這個宣告自訂型別的程式碼</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ages</span> <span style="color:#66d9ef">int</span>

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">money</span> <span style="color:#66d9ef">float32</span>

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">months</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">int</span>

<span style="color:#a6e22e">m</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">months</span> {
	<span style="color:#e6db74">&#34;January&#34;</span>:<span style="color:#ae81ff">31</span>,
	<span style="color:#e6db74">&#34;February&#34;</span>:<span style="color:#ae81ff">28</span>,
	<span style="color:#f92672">...</span>
	<span style="color:#e6db74">&#34;December&#34;</span>:<span style="color:#ae81ff">31</span>,
}</code></pre></div>
<p>看到了嗎？簡單的很吧，這樣你就可以在自己的程式碼裡面定義有意義的型別了，實際上只是一個定義了一個別名，有點類似於 c 中的 typedef，例如上面 ages 替代了 int</p>

<p>好了，讓我們回到<code>method</code></p>

<p>你可以在任何的自訂型別中定義任意多的<code>method</code>，接下來讓我們看一個複雜一點的例子</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;fmt&#34;</span>

<span style="color:#66d9ef">const</span>(
	<span style="color:#a6e22e">WHITE</span> = <span style="color:#66d9ef">iota</span>
	<span style="color:#a6e22e">BLACK</span>
	<span style="color:#a6e22e">BLUE</span>
	<span style="color:#a6e22e">RED</span>
	<span style="color:#a6e22e">YELLOW</span>
)

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Color</span> <span style="color:#66d9ef">byte</span>

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Box</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">width</span>, <span style="color:#a6e22e">height</span>, <span style="color:#a6e22e">depth</span> <span style="color:#66d9ef">float64</span>
	<span style="color:#a6e22e">color</span> <span style="color:#a6e22e">Color</span>
}

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">BoxList</span> []<span style="color:#a6e22e">Box</span> <span style="color:#75715e">//a slice of boxes
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">b</span> <span style="color:#a6e22e">Box</span>) <span style="color:#a6e22e">Volume</span>() <span style="color:#66d9ef">float64</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">width</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">height</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">depth</span>
}

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">b</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Box</span>) <span style="color:#a6e22e">SetColor</span>(<span style="color:#a6e22e">c</span> <span style="color:#a6e22e">Color</span>) {
	<span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">color</span> = <span style="color:#a6e22e">c</span>
}

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">bl</span> <span style="color:#a6e22e">BoxList</span>) <span style="color:#a6e22e">BiggestColor</span>() <span style="color:#a6e22e">Color</span> {
	<span style="color:#a6e22e">v</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0.00</span>
	<span style="color:#a6e22e">k</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Color</span>(<span style="color:#a6e22e">WHITE</span>)
	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">b</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">bl</span> {
		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">bv</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">Volume</span>(); <span style="color:#a6e22e">bv</span> &gt; <span style="color:#a6e22e">v</span> {
			<span style="color:#a6e22e">v</span> = <span style="color:#a6e22e">bv</span>
			<span style="color:#a6e22e">k</span> = <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">color</span>
		}
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">k</span>
}

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">bl</span> <span style="color:#a6e22e">BoxList</span>) <span style="color:#a6e22e">PaintItBlack</span>() {
	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">bl</span> {
		<span style="color:#a6e22e">bl</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">SetColor</span>(<span style="color:#a6e22e">BLACK</span>)
	}
}

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">c</span> <span style="color:#a6e22e">Color</span>) <span style="color:#a6e22e">String</span>() <span style="color:#66d9ef">string</span> {
	<span style="color:#a6e22e">strings</span> <span style="color:#f92672">:=</span> []<span style="color:#66d9ef">string</span> {<span style="color:#e6db74">&#34;WHITE&#34;</span>, <span style="color:#e6db74">&#34;BLACK&#34;</span>, <span style="color:#e6db74">&#34;BLUE&#34;</span>, <span style="color:#e6db74">&#34;RED&#34;</span>, <span style="color:#e6db74">&#34;YELLOW&#34;</span>}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">strings</span>[<span style="color:#a6e22e">c</span>]
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#a6e22e">boxes</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">BoxList</span> {
		<span style="color:#a6e22e">Box</span>{<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">4</span>, <span style="color:#a6e22e">RED</span>},
		<span style="color:#a6e22e">Box</span>{<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">YELLOW</span>},
		<span style="color:#a6e22e">Box</span>{<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">20</span>, <span style="color:#a6e22e">BLACK</span>},
		<span style="color:#a6e22e">Box</span>{<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">BLUE</span>},
		<span style="color:#a6e22e">Box</span>{<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">WHITE</span>},
		<span style="color:#a6e22e">Box</span>{<span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">20</span>, <span style="color:#a6e22e">YELLOW</span>},
	}

	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;We have %d boxes in our set\n&#34;</span>, len(<span style="color:#a6e22e">boxes</span>))
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;The volume of the first one is&#34;</span>, <span style="color:#a6e22e">boxes</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">Volume</span>(), <span style="color:#e6db74">&#34;cm³&#34;</span>)
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;The color of the last one is&#34;</span>,<span style="color:#a6e22e">boxes</span>[len(<span style="color:#a6e22e">boxes</span>)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>].<span style="color:#a6e22e">color</span>.<span style="color:#a6e22e">String</span>())
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;The biggest one is&#34;</span>, <span style="color:#a6e22e">boxes</span>.<span style="color:#a6e22e">BiggestColor</span>().<span style="color:#a6e22e">String</span>())

	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Let&#39;s paint them all black&#34;</span>)
	<span style="color:#a6e22e">boxes</span>.<span style="color:#a6e22e">PaintItBlack</span>()
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;The color of the second one is&#34;</span>, <span style="color:#a6e22e">boxes</span>[<span style="color:#ae81ff">1</span>].<span style="color:#a6e22e">color</span>.<span style="color:#a6e22e">String</span>())

	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Obviously, now, the biggest one is&#34;</span>, <span style="color:#a6e22e">boxes</span>.<span style="color:#a6e22e">BiggestColor</span>().<span style="color:#a6e22e">String</span>())
}</code></pre></div>
<p>上面的程式碼透過 const 定義了一些常數，然後定義了一些自訂型別</p>

<ul>
<li>Color 作為 byte 的別名</li>
<li>定義了一個 struct:Box，含有三個長寬高欄位和一個顏色屬性</li>
<li>定義了一個 slice:BoxList，含有 Box</li>
</ul>

<p>然後以上面的自訂型別為接收者定義了一些 method</p>

<ul>
<li>Volume()定義了接收者為 Box，回傳 Box 的容量</li>
<li>SetColor(c Color)，把 Box 的顏色改為 c</li>
<li>BiggestColor()定在在 BoxList 上面，回傳 list 裡面容量最大的顏色</li>
<li>PaintItBlack()把 BoxList 裡面所有 Box 的顏色全部變成黑色</li>
<li>String()定義在 Color 上面，回傳 Color 的具體顏色(字串格式)</li>
</ul>

<p>上面的程式碼透過文字描述出來之後是不是很簡單？我們一般解決問題都是透過問題的描述，去寫相應的程式碼實現。</p>

<h3 id="指標作為-receiver">指標作為 receiver</h3>

<p>現在讓我們回過頭來看看 SetColor 這個 method，它的 receiver 是一個指向 Box 的指標，是的，你可以使用*Box。想想為啥要使用指標而不是 Box 本身呢？</p>

<p>我們定義 SetColor 的真正目的是想改變這個 Box 的顏色，如果不傳 Box 的指標，那麼 SetColor 接受的其實是 Box 的一個 copy，也就是說 method 內對於顏色值的修改，其實只作用於 Box 的 copy，而不是真正的 Box。所以我們需要傳入指標。</p>

<p>這裡可以把 receiver 當作 method 的第一個參數來看，然後結合前面函式講解的傳值和傳參考就不難理解</p>

<p>這裡你也許會問了那 SetColor 函式裡面應該這樣定義<code>*b.Color=c</code>，而不是<code>b.Color=c</code>，因為我們需要讀取到指標相應的值。</p>

<p>你是對的，其實 Go 裡面這兩種方式都是正確的，當你用指標去訪問相應的欄位時(雖然指標沒有任何的欄位)，Go 知道你要透過指標去取得這個值，看到了吧，Go 的設計是不是越來越吸引你了。</p>

<p>也許細心的讀者會問這樣的問題，PaintItBlack 裡面呼叫 SetColor 的時候是不是應該寫成<code>(&amp;bl[i]).SetColor(BLACK)</code>，因為 SetColor 的 receiver 是*Box，而不是 Box。</p>

<p>你又說對了，這兩種方式都可以，因為 Go 知道 receiver 是指標，他自動幫你轉了。</p>

<p>也就是說：
&gt;如果一個 method 的 receiver 是 *T，你可以在一個 T 型別的變數 V 上面呼叫這個 method，而不需要 &amp;V 去呼叫這個 method</p>

<p>類似的
&gt;如果一個 method 的 receiver 是 T，你可以在一個*T 型別的變數 P 上面呼叫這個 method，而不需要 *P 去呼叫這個 method</p>

<p>所以，你不用擔心你是呼叫的指標的 method 還是不是指標的 method，Go 知道你要做的一切，這對於有多年 C/C++程式設計經驗的同學來說，真是解決了一個很大的痛苦。</p>

<h3 id="method-繼承">method 繼承</h3>

<p>前面一章我們學習了欄位的繼承，那麼你也會發現 Go 的一個神奇之處，method 也是可以繼承的。如果匿名欄位實現了一個 method，那麼包含這個匿名欄位的 struct 也能呼叫該 method。讓我們來看下面這個例子</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;fmt&#34;</span>

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Human</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">age</span> <span style="color:#66d9ef">int</span>
	<span style="color:#a6e22e">phone</span> <span style="color:#66d9ef">string</span>
}

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Student</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">Human</span> <span style="color:#75715e">//匿名欄位
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">school</span> <span style="color:#66d9ef">string</span>
}

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Employee</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">Human</span> <span style="color:#75715e">//匿名欄位
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">company</span> <span style="color:#66d9ef">string</span>
}

<span style="color:#75715e">//在 human 上面定義了一個 method
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">h</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Human</span>) <span style="color:#a6e22e">SayHi</span>() {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Hi, I am %s you can call me on %s\n&#34;</span>, <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">phone</span>)
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#a6e22e">mark</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Student</span>{<span style="color:#a6e22e">Human</span>{<span style="color:#e6db74">&#34;Mark&#34;</span>, <span style="color:#ae81ff">25</span>, <span style="color:#e6db74">&#34;222-222-YYYY&#34;</span>}, <span style="color:#e6db74">&#34;MIT&#34;</span>}
	<span style="color:#a6e22e">sam</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Employee</span>{<span style="color:#a6e22e">Human</span>{<span style="color:#e6db74">&#34;Sam&#34;</span>, <span style="color:#ae81ff">45</span>, <span style="color:#e6db74">&#34;111-888-XXXX&#34;</span>}, <span style="color:#e6db74">&#34;Golang Inc&#34;</span>}

	<span style="color:#a6e22e">mark</span>.<span style="color:#a6e22e">SayHi</span>()
	<span style="color:#a6e22e">sam</span>.<span style="color:#a6e22e">SayHi</span>()
}</code></pre></div>
<h3 id="method-重寫">method 重寫</h3>

<p>上面的例子中，如果 Employee 想要實現自己的 SayHi，怎麼辦？簡單，和匿名欄位衝突一樣的道理，我們可以在 Employee 上面定義一個 method，重寫了匿名欄位的方法。請看下面的例子</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Go" data-lang="Go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;fmt&#34;</span>

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Human</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">age</span> <span style="color:#66d9ef">int</span>
	<span style="color:#a6e22e">phone</span> <span style="color:#66d9ef">string</span>
}

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Student</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">Human</span> <span style="color:#75715e">//匿名欄位
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">school</span> <span style="color:#66d9ef">string</span>
}

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Employee</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">Human</span> <span style="color:#75715e">//匿名欄位
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">company</span> <span style="color:#66d9ef">string</span>
}

<span style="color:#75715e">//Human 定義 method
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">h</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Human</span>) <span style="color:#a6e22e">SayHi</span>() {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Hi, I am %s you can call me on %s\n&#34;</span>, <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">phone</span>)
}

<span style="color:#75715e">//Employee 的 method 重寫 Human 的 method
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">e</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Employee</span>) <span style="color:#a6e22e">SayHi</span>() {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Hi, I am %s, I work at %s. Call me on %s\n&#34;</span>, <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">name</span>,
		<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">company</span>, <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">phone</span>) <span style="color:#75715e">//Yes you can split into 2 lines here.
</span><span style="color:#75715e"></span>}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#a6e22e">mark</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Student</span>{<span style="color:#a6e22e">Human</span>{<span style="color:#e6db74">&#34;Mark&#34;</span>, <span style="color:#ae81ff">25</span>, <span style="color:#e6db74">&#34;222-222-YYYY&#34;</span>}, <span style="color:#e6db74">&#34;MIT&#34;</span>}
	<span style="color:#a6e22e">sam</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Employee</span>{<span style="color:#a6e22e">Human</span>{<span style="color:#e6db74">&#34;Sam&#34;</span>, <span style="color:#ae81ff">45</span>, <span style="color:#e6db74">&#34;111-888-XXXX&#34;</span>}, <span style="color:#e6db74">&#34;Golang Inc&#34;</span>}

	<span style="color:#a6e22e">mark</span>.<span style="color:#a6e22e">SayHi</span>()
	<span style="color:#a6e22e">sam</span>.<span style="color:#a6e22e">SayHi</span>()
}</code></pre></div>
<p>上面的程式碼設計的是如此的美妙，讓人不自覺的為 Go 的設計驚歎！</p>

<p>透過這些內容，我們可以設計出基本的物件導向的程式了，但是 Go 裡面的物件導向是如此的簡單，沒有任何的私有、公有關鍵字，透過大小寫來實現(大寫開頭的為公有，小寫開頭的為私有)，方法也同樣適用這個原則。</p>

<h2 id="links">links</h2>

<ul>
<li><a href="docs/preface">目錄</a></li>
<li>上一章: <a href="docs/02.4">struct 型別</a></li>
<li>下一節: <a href="docs/02.6">interface</a></li>
</ul>
</article>

      
<div class="book-footer justify-between">
  
  <div>
    
    <a href="/commit/fda25aafea9413c8ec77f5df29d5f6bb5f7dc3a6" title='Last modified Sep 21, 2019 by Jiuxiao' target="_blank" rel="noopener">
      <img src="/buildWebWithGolangTw/svg/calendar.svg" alt="Changed" /> Sep 21, 2019
    </a>
  </div>
  
  
</div>


      
    </div>

    
  

  <aside class="book-toc level-3 fixed">
    <nav id="TableOfContents">
<ul>
<li><a href="#2-5-物件導向">2.5 物件導向</a>
<ul>
<li><a href="#method">method</a>
<ul>
<li><a href="#指標作為-receiver">指標作為 receiver</a></li>
<li><a href="#method-繼承">method 繼承</a></li>
<li><a href="#method-重寫">method 重寫</a></li>
</ul></li>
<li><a href="#links">links</a></li>
</ul></li>
</ul>
</nav>
  </aside>



  </main>

  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-148025936-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</body>

</html>
